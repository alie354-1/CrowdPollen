import{r as u,a as Pt,R as _t,b as It}from"./vendor-C1JoJ-56.js";import{c as kt,_ as Mt}from"./services-JCfgYN9M.js";import{H as Lt,C as B,M as Ve,F as Et,S as qe,a as O,T as xe,U as Ke,I as At,X as Pe,Z as Tt,b as Dt,R as Rt,N as _e,L as Ie,A as q,c as Ot,d as $t,e as Gt,P as ke,f as Ft,g as ge,B as me,G as Me,h as Ut,i as Wt,D as zt,j as Bt,k as Le,l as Ee,m as Ht,n as Je,o as Vt}from"./ui-DDrkIc5X.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function a(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=a(n);fetch(n.href,o)}})();var Ye={exports:{}},ie={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qt=u,Kt=Symbol.for("react.element"),Jt=Symbol.for("react.fragment"),Yt=Object.prototype.hasOwnProperty,Zt=qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Qt={key:!0,ref:!0,__self:!0,__source:!0};function Ze(s,t,a){var r,n={},o=null,l=null;a!==void 0&&(o=""+a),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(l=t.ref);for(r in t)Yt.call(t,r)&&!Qt.hasOwnProperty(r)&&(n[r]=t[r]);if(s&&s.defaultProps)for(r in t=s.defaultProps,t)n[r]===void 0&&(n[r]=t[r]);return{$$typeof:Kt,type:s,key:o,ref:l,props:n,_owner:Zt.current}}ie.Fragment=Jt;ie.jsx=Ze;ie.jsxs=Ze;Ye.exports=ie;var e=Ye.exports,fe={},Ae=Pt;fe.createRoot=Ae.createRoot,fe.hydrateRoot=Ae.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ee(){return ee=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(s[r]=a[r])}return s},ee.apply(this,arguments)}var U;(function(s){s.Pop="POP",s.Push="PUSH",s.Replace="REPLACE"})(U||(U={}));const Te="popstate";function Xt(s){s===void 0&&(s={});function t(r,n){let{pathname:o,search:l,hash:h}=r.location;return pe("",{pathname:o,search:l,hash:h},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function a(r,n){return typeof n=="string"?n:Xe(n)}return ts(t,a,null,s)}function T(s,t){if(s===!1||s===null||typeof s>"u")throw new Error(t)}function Qe(s,t){if(!s){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function es(){return Math.random().toString(36).substr(2,8)}function De(s,t){return{usr:s.state,key:s.key,idx:t}}function pe(s,t,a,r){return a===void 0&&(a=null),ee({pathname:typeof s=="string"?s:s.pathname,search:"",hash:""},typeof t=="string"?K(t):t,{state:a,key:t&&t.key||r||es()})}function Xe(s){let{pathname:t="/",search:a="",hash:r=""}=s;return a&&a!=="?"&&(t+=a.charAt(0)==="?"?a:"?"+a),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function K(s){let t={};if(s){let a=s.indexOf("#");a>=0&&(t.hash=s.substr(a),s=s.substr(0,a));let r=s.indexOf("?");r>=0&&(t.search=s.substr(r),s=s.substr(0,r)),s&&(t.pathname=s)}return t}function ts(s,t,a,r){r===void 0&&(r={});let{window:n=document.defaultView,v5Compat:o=!1}=r,l=n.history,h=U.Pop,c=null,m=g();m==null&&(m=0,l.replaceState(ee({},l.state,{idx:m}),""));function g(){return(l.state||{idx:null}).idx}function x(){h=U.Pop;let w=g(),p=w==null?null:w-m;m=w,c&&c({action:h,location:N.location,delta:p})}function b(w,p){h=U.Push;let i=pe(N.location,w,p);m=g()+1;let y=De(i,m),d=N.createHref(i);try{l.pushState(y,"",d)}catch(f){if(f instanceof DOMException&&f.name==="DataCloneError")throw f;n.location.assign(d)}o&&c&&c({action:h,location:N.location,delta:1})}function S(w,p){h=U.Replace;let i=pe(N.location,w,p);m=g();let y=De(i,m),d=N.createHref(i);l.replaceState(y,"",d),o&&c&&c({action:h,location:N.location,delta:0})}function j(w){let p=n.location.origin!=="null"?n.location.origin:n.location.href,i=typeof w=="string"?w:Xe(w);return i=i.replace(/ $/,"%20"),T(p,"No window.location.(origin|href) available to create URL for href: "+i),new URL(i,p)}let N={get action(){return h},get location(){return s(n,l)},listen(w){if(c)throw new Error("A history only accepts one active listener");return n.addEventListener(Te,x),c=w,()=>{n.removeEventListener(Te,x),c=null}},createHref(w){return t(n,w)},createURL:j,encodeLocation(w){let p=j(w);return{pathname:p.pathname,search:p.search,hash:p.hash}},push:b,replace:S,go(w){return l.go(w)}};return N}var Re;(function(s){s.data="data",s.deferred="deferred",s.redirect="redirect",s.error="error"})(Re||(Re={}));function ss(s,t,a){return a===void 0&&(a="/"),as(s,t,a)}function as(s,t,a,r){let n=typeof t=="string"?K(t):t,o=st(n.pathname||"/",a);if(o==null)return null;let l=et(s);rs(l);let h=null;for(let c=0;h==null&&c<l.length;++c){let m=fs(o);h=hs(l[c],m)}return h}function et(s,t,a,r){t===void 0&&(t=[]),a===void 0&&(a=[]),r===void 0&&(r="");let n=(o,l,h)=>{let c={relativePath:h===void 0?o.path||"":h,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};c.relativePath.startsWith("/")&&(T(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let m=W([r,c.relativePath]),g=a.concat(c);o.children&&o.children.length>0&&(T(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),et(o.children,t,g,m)),!(o.path==null&&!o.index)&&t.push({path:m,score:us(m,o.index),routesMeta:g})};return s.forEach((o,l)=>{var h;if(o.path===""||!((h=o.path)!=null&&h.includes("?")))n(o,l);else for(let c of tt(o.path))n(o,l,c)}),t}function tt(s){let t=s.split("/");if(t.length===0)return[];let[a,...r]=t,n=a.endsWith("?"),o=a.replace(/\?$/,"");if(r.length===0)return n?[o,""]:[o];let l=tt(r.join("/")),h=[];return h.push(...l.map(c=>c===""?o:[o,c].join("/"))),n&&h.push(...l),h.map(c=>s.startsWith("/")&&c===""?"/":c)}function rs(s){s.sort((t,a)=>t.score!==a.score?a.score-t.score:ms(t.routesMeta.map(r=>r.childrenIndex),a.routesMeta.map(r=>r.childrenIndex)))}const ns=/^:[\w-]+$/,os=3,ls=2,is=1,cs=10,ds=-2,Oe=s=>s==="*";function us(s,t){let a=s.split("/"),r=a.length;return a.some(Oe)&&(r+=ds),t&&(r+=ls),a.filter(n=>!Oe(n)).reduce((n,o)=>n+(ns.test(o)?os:o===""?is:cs),r)}function ms(s,t){return s.length===t.length&&s.slice(0,-1).every((r,n)=>r===t[n])?s[s.length-1]-t[t.length-1]:0}function hs(s,t,a){let{routesMeta:r}=s,n={},o="/",l=[];for(let h=0;h<r.length;++h){let c=r[h],m=h===r.length-1,g=o==="/"?t:t.slice(o.length)||"/",x=xs({path:c.relativePath,caseSensitive:c.caseSensitive,end:m},g),b=c.route;if(!x)return null;Object.assign(n,x.params),l.push({params:n,pathname:W([o,x.pathname]),pathnameBase:bs(W([o,x.pathnameBase])),route:b}),x.pathnameBase!=="/"&&(o=W([o,x.pathnameBase]))}return l}function xs(s,t){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[a,r]=gs(s.path,s.caseSensitive,s.end),n=t.match(a);if(!n)return null;let o=n[0],l=o.replace(/(.)\/+$/,"$1"),h=n.slice(1);return{params:r.reduce((m,g,x)=>{let{paramName:b,isOptional:S}=g;if(b==="*"){let N=h[x]||"";l=o.slice(0,o.length-N.length).replace(/(.)\/+$/,"$1")}const j=h[x];return S&&!j?m[b]=void 0:m[b]=(j||"").replace(/%2F/g,"/"),m},{}),pathname:o,pathnameBase:l,pattern:s}}function gs(s,t,a){t===void 0&&(t=!1),a===void 0&&(a=!0),Qe(s==="*"||!s.endsWith("*")||s.endsWith("/*"),'Route path "'+s+'" will be treated as if it were '+('"'+s.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+s.replace(/\*$/,"/*")+'".'));let r=[],n="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,h,c)=>(r.push({paramName:h,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return s.endsWith("*")?(r.push({paramName:"*"}),n+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?n+="\\/*$":s!==""&&s!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,t?void 0:"i"),r]}function fs(s){try{return s.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Qe(!1,'The URL path "'+s+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),s}}function st(s,t){if(t==="/")return s;if(!s.toLowerCase().startsWith(t.toLowerCase()))return null;let a=t.endsWith("/")?t.length-1:t.length,r=s.charAt(a);return r&&r!=="/"?null:s.slice(a)||"/"}function ps(s,t){t===void 0&&(t="/");let{pathname:a,search:r="",hash:n=""}=typeof s=="string"?K(s):s;return{pathname:a?a.startsWith("/")?a:ys(a,t):t,search:ws(r),hash:js(n)}}function ys(s,t){let a=t.replace(/\/+$/,"").split("/");return s.split("/").forEach(n=>{n===".."?a.length>1&&a.pop():n!=="."&&a.push(n)}),a.length>1?a.join("/"):"/"}function he(s,t,a,r){return"Cannot include a '"+s+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+a+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function vs(s){return s.filter((t,a)=>a===0||t.route.path&&t.route.path.length>0)}function at(s,t){let a=vs(s);return t?a.map((r,n)=>n===a.length-1?r.pathname:r.pathnameBase):a.map(r=>r.pathnameBase)}function rt(s,t,a,r){r===void 0&&(r=!1);let n;typeof s=="string"?n=K(s):(n=ee({},s),T(!n.pathname||!n.pathname.includes("?"),he("?","pathname","search",n)),T(!n.pathname||!n.pathname.includes("#"),he("#","pathname","hash",n)),T(!n.search||!n.search.includes("#"),he("#","search","hash",n)));let o=s===""||n.pathname==="",l=o?"/":n.pathname,h;if(l==null)h=a;else{let x=t.length-1;if(!r&&l.startsWith("..")){let b=l.split("/");for(;b[0]==="..";)b.shift(),x-=1;n.pathname=b.join("/")}h=x>=0?t[x]:"/"}let c=ps(n,h),m=l&&l!=="/"&&l.endsWith("/"),g=(o||l===".")&&a.endsWith("/");return!c.pathname.endsWith("/")&&(m||g)&&(c.pathname+="/"),c}const W=s=>s.join("/").replace(/\/\/+/g,"/"),bs=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),ws=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,js=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s;function Ns(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}const nt=["post","put","patch","delete"];new Set(nt);const Ss=["get",...nt];new Set(Ss);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function te(){return te=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(s[r]=a[r])}return s},te.apply(this,arguments)}const ve=u.createContext(null),Cs=u.createContext(null),se=u.createContext(null),ce=u.createContext(null),V=u.createContext({outlet:null,matches:[],isDataRoute:!1}),ot=u.createContext(null);function ae(){return u.useContext(ce)!=null}function de(){return ae()||T(!1),u.useContext(ce).location}function lt(s){u.useContext(se).static||u.useLayoutEffect(s)}function ue(){let{isDataRoute:s}=u.useContext(V);return s?$s():Ps()}function Ps(){ae()||T(!1);let s=u.useContext(ve),{basename:t,future:a,navigator:r}=u.useContext(se),{matches:n}=u.useContext(V),{pathname:o}=de(),l=JSON.stringify(at(n,a.v7_relativeSplatPath)),h=u.useRef(!1);return lt(()=>{h.current=!0}),u.useCallback(function(m,g){if(g===void 0&&(g={}),!h.current)return;if(typeof m=="number"){r.go(m);return}let x=rt(m,JSON.parse(l),o,g.relative==="path");s==null&&t!=="/"&&(x.pathname=x.pathname==="/"?t:W([t,x.pathname])),(g.replace?r.replace:r.push)(x,g.state,g)},[t,r,l,o,s])}function _s(s,t){return Is(s,t)}function Is(s,t,a,r){ae()||T(!1);let{navigator:n}=u.useContext(se),{matches:o}=u.useContext(V),l=o[o.length-1],h=l?l.params:{};l&&l.pathname;let c=l?l.pathnameBase:"/";l&&l.route;let m=de(),g;if(t){var x;let w=typeof t=="string"?K(t):t;c==="/"||(x=w.pathname)!=null&&x.startsWith(c)||T(!1),g=w}else g=m;let b=g.pathname||"/",S=b;if(c!=="/"){let w=c.replace(/^\//,"").split("/");S="/"+b.replace(/^\//,"").split("/").slice(w.length).join("/")}let j=ss(s,{pathname:S}),N=As(j&&j.map(w=>Object.assign({},w,{params:Object.assign({},h,w.params),pathname:W([c,n.encodeLocation?n.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?c:W([c,n.encodeLocation?n.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),o,a,r);return t&&N?u.createElement(ce.Provider,{value:{location:te({pathname:"/",search:"",hash:"",state:null,key:"default"},g),navigationType:U.Pop}},N):N}function ks(){let s=Os(),t=Ns(s)?s.status+" "+s.statusText:s instanceof Error?s.message:JSON.stringify(s),a=s instanceof Error?s.stack:null,n={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return u.createElement(u.Fragment,null,u.createElement("h2",null,"Unexpected Application Error!"),u.createElement("h3",{style:{fontStyle:"italic"}},t),a?u.createElement("pre",{style:n},a):null,null)}const Ms=u.createElement(ks,null);class Ls extends u.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,a){return a.location!==t.location||a.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:a.error,location:a.location,revalidation:t.revalidation||a.revalidation}}componentDidCatch(t,a){console.error("React Router caught the following error during render",t,a)}render(){return this.state.error!==void 0?u.createElement(V.Provider,{value:this.props.routeContext},u.createElement(ot.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Es(s){let{routeContext:t,match:a,children:r}=s,n=u.useContext(ve);return n&&n.static&&n.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=a.route.id),u.createElement(V.Provider,{value:t},r)}function As(s,t,a,r){var n;if(t===void 0&&(t=[]),a===void 0&&(a=null),r===void 0&&(r=null),s==null){var o;if(!a)return null;if(a.errors)s=a.matches;else if((o=r)!=null&&o.v7_partialHydration&&t.length===0&&!a.initialized&&a.matches.length>0)s=a.matches;else return null}let l=s,h=(n=a)==null?void 0:n.errors;if(h!=null){let g=l.findIndex(x=>x.route.id&&(h==null?void 0:h[x.route.id])!==void 0);g>=0||T(!1),l=l.slice(0,Math.min(l.length,g+1))}let c=!1,m=-1;if(a&&r&&r.v7_partialHydration)for(let g=0;g<l.length;g++){let x=l[g];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(m=g),x.route.id){let{loaderData:b,errors:S}=a,j=x.route.loader&&b[x.route.id]===void 0&&(!S||S[x.route.id]===void 0);if(x.route.lazy||j){c=!0,m>=0?l=l.slice(0,m+1):l=[l[0]];break}}}return l.reduceRight((g,x,b)=>{let S,j=!1,N=null,w=null;a&&(S=h&&x.route.id?h[x.route.id]:void 0,N=x.route.errorElement||Ms,c&&(m<0&&b===0?(Gs("route-fallback"),j=!0,w=null):m===b&&(j=!0,w=x.route.hydrateFallbackElement||null)));let p=t.concat(l.slice(0,b+1)),i=()=>{let y;return S?y=N:j?y=w:x.route.Component?y=u.createElement(x.route.Component,null):x.route.element?y=x.route.element:y=g,u.createElement(Es,{match:x,routeContext:{outlet:g,matches:p,isDataRoute:a!=null},children:y})};return a&&(x.route.ErrorBoundary||x.route.errorElement||b===0)?u.createElement(Ls,{location:a.location,revalidation:a.revalidation,component:N,error:S,children:i(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):i()},null)}var it=function(s){return s.UseBlocker="useBlocker",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s}(it||{}),ct=function(s){return s.UseBlocker="useBlocker",s.UseLoaderData="useLoaderData",s.UseActionData="useActionData",s.UseRouteError="useRouteError",s.UseNavigation="useNavigation",s.UseRouteLoaderData="useRouteLoaderData",s.UseMatches="useMatches",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s.UseRouteId="useRouteId",s}(ct||{});function Ts(s){let t=u.useContext(ve);return t||T(!1),t}function Ds(s){let t=u.useContext(Cs);return t||T(!1),t}function Rs(s){let t=u.useContext(V);return t||T(!1),t}function dt(s){let t=Rs(),a=t.matches[t.matches.length-1];return a.route.id||T(!1),a.route.id}function Os(){var s;let t=u.useContext(ot),a=Ds(),r=dt();return t!==void 0?t:(s=a.errors)==null?void 0:s[r]}function $s(){let{router:s}=Ts(it.UseNavigateStable),t=dt(ct.UseNavigateStable),a=u.useRef(!1);return lt(()=>{a.current=!0}),u.useCallback(function(n,o){o===void 0&&(o={}),a.current&&(typeof n=="number"?s.navigate(n):s.navigate(n,te({fromRouteId:t},o)))},[s,t])}const $e={};function Gs(s,t,a){$e[s]||($e[s]=!0)}function Fs(s,t){s==null||s.v7_startTransition,s==null||s.v7_relativeSplatPath}function Us(s){let{to:t,replace:a,state:r,relative:n}=s;ae()||T(!1);let{future:o,static:l}=u.useContext(se),{matches:h}=u.useContext(V),{pathname:c}=de(),m=ue(),g=rt(t,at(h,o.v7_relativeSplatPath),c,n==="path"),x=JSON.stringify(g);return u.useEffect(()=>m(JSON.parse(x),{replace:a,state:r,relative:n}),[m,x,n,a,r]),null}function F(s){T(!1)}function Ws(s){let{basename:t="/",children:a=null,location:r,navigationType:n=U.Pop,navigator:o,static:l=!1,future:h}=s;ae()&&T(!1);let c=t.replace(/^\/*/,"/"),m=u.useMemo(()=>({basename:c,navigator:o,static:l,future:te({v7_relativeSplatPath:!1},h)}),[c,h,o,l]);typeof r=="string"&&(r=K(r));let{pathname:g="/",search:x="",hash:b="",state:S=null,key:j="default"}=r,N=u.useMemo(()=>{let w=st(g,c);return w==null?null:{location:{pathname:w,search:x,hash:b,state:S,key:j},navigationType:n}},[c,g,x,b,S,j,n]);return N==null?null:u.createElement(se.Provider,{value:m},u.createElement(ce.Provider,{children:a,value:N}))}function zs(s){let{children:t,location:a}=s;return _s(ye(t),a)}new Promise(()=>{});function ye(s,t){t===void 0&&(t=[]);let a=[];return u.Children.forEach(s,(r,n)=>{if(!u.isValidElement(r))return;let o=[...t,n];if(r.type===u.Fragment){a.push.apply(a,ye(r.props.children,o));return}r.type!==F&&T(!1),!r.props.index||!r.props.children||T(!1);let l={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=ye(r.props.children,o)),a.push(l)}),a}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const Bs="6";try{window.__reactRouterVersion=Bs}catch{}const Hs="startTransition",Ge=_t[Hs];function Vs(s){let{basename:t,children:a,future:r,window:n}=s,o=u.useRef();o.current==null&&(o.current=Xt({window:n,v5Compat:!0}));let l=o.current,[h,c]=u.useState({action:l.action,location:l.location}),{v7_startTransition:m}=r||{},g=u.useCallback(x=>{m&&Ge?Ge(()=>c(x)):c(x)},[c,m]);return u.useLayoutEffect(()=>l.listen(g),[l,g]),u.useEffect(()=>Fs(r),[r]),u.createElement(Ws,{basename:t,children:a,location:h.location,navigationType:h.action,navigator:l,future:r})}var Fe;(function(s){s.UseScrollRestoration="useScrollRestoration",s.UseSubmit="useSubmit",s.UseSubmitFetcher="useSubmitFetcher",s.UseFetcher="useFetcher",s.useViewTransitionState="useViewTransitionState"})(Fe||(Fe={}));var Ue;(function(s){s.UseFetcher="useFetcher",s.UseFetchers="useFetchers",s.UseScrollRestoration="useScrollRestoration"})(Ue||(Ue={}));const qs="https://ujpwvxufomnqurvvptki.supabase.co",Ks="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVqcHd2eHVmb21ucXVydnZwdGtpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE0Njk5NzIsImV4cCI6MjA2NzA0NTk3Mn0.AGYFVJj_KSmQaWI6ctLhUjZjHQmiyHS82clcUxDN_Gs",$=kt(qs,Ks),ut=u.createContext({});function re(){const s=u.useContext(ut);if(!s)throw new Error("useAuth must be used within an AuthProvider");return s}function Js({children:s}){const[t,a]=u.useState(null),[r,n]=u.useState(null),[o,l]=u.useState(!0),[h,c]=u.useState(!0);u.useEffect(()=>{m();const{data:{subscription:d}}=$.auth.onAuthStateChange(async(f,v)=>{v!=null&&v.user?(a(v.user),c(!1),await g(v.user.id)):(a(null),n(null),c(!0)),l(!1)});return()=>d.unsubscribe()},[]);const m=async()=>{try{const{data:{session:d}}=await $.auth.getSession();d!=null&&d.user?(a(d.user),c(!1),await g(d.user.id)):c(!0)}catch(d){console.error("Error getting initial session:",d)}finally{l(!1)}},g=async d=>{try{const{data:f,error:v}=await $.from("user_profiles").select("*").eq("user_id",d).single();if(v&&v.code!=="PGRST116")throw v;f?n(f):await x(d)}catch(f){console.error("Error loading user profile:",f)}},x=async d=>{var f;try{const{data:v,error:P}=await $.from("user_profiles").insert({user_id:d,display_name:((f=t==null?void 0:t.user_metadata)==null?void 0:f.display_name)||null,privacy_level:"anonymous",account_type:"individual",notification_preferences:{symptom_reminders:!0,high_pollen_alerts:!0,weekly_reports:!1}}).select().single();if(P)throw P;n(v)}catch(v){console.error("Error creating user profile:",v)}},b=async(d,f,v={})=>{try{l(!0);const{data:P,error:_}=await $.auth.signUp({email:d,password:f,options:{data:v}});if(_)throw _;return{data:P,error:null}}catch(P){return console.error("Sign up error:",P),{data:null,error:P}}finally{l(!1)}},S=async(d,f)=>{try{l(!0);const{data:v,error:P}=await $.auth.signInWithPassword({email:d,password:f});if(P)throw P;return{data:v,error:null}}catch(v){return console.error("Sign in error:",v),{data:null,error:v}}finally{l(!1)}},j=async()=>{try{l(!0);const{error:d}=await $.auth.signOut();if(d)throw d;a(null),n(null),c(!0)}catch(d){console.error("Sign out error:",d)}finally{l(!1)}},y={user:t,profile:r,loading:o,isAnonymous:h,signUp:b,signIn:S,signOut:j,updateProfile:async d=>{try{if(!t)throw new Error("No user logged in");const{data:f,error:v}=await $.from("user_profiles").update(d).eq("user_id",t.id).select().single();if(v)throw v;return n(f),{data:f,error:null}}catch(f){return console.error("Update profile error:",f),{data:null,error:f}}},resetPassword:async d=>{try{const{data:f,error:v}=await $.auth.resetPasswordForEmail(d,{redirectTo:`${window.location.origin}/reset-password`});if(v)throw v;return{data:f,error:null}}catch(f){return console.error("Reset password error:",f),{data:null,error:f}}},updatePassword:async d=>{try{const{data:f,error:v}=await $.auth.updateUser({password:d});if(v)throw v;return{data:f,error:null}}catch(f){return console.error("Update password error:",f),{data:null,error:f}}},deleteAccount:async()=>{try{if(!t)throw new Error("No user logged in");const{error:d}=await $.from("user_profiles").delete().eq("user_id",t.id);if(d)throw d;return await j(),{error:null}}catch(d){return console.error("Delete account error:",d),{error:d}}},isAuthenticated:!!t,hasProfile:!!r};return e.jsx(ut.Provider,{value:y,children:s})}class Ys{constructor(){this.apiKey="AIzaSyB_Fj3F0vAmvCNBGMGIN90fQtk85cuxj1s",this.baseUrl="https://maps.googleapis.com/maps/api",this.isLoaded=!1,this.loadPromise=null}async loadGoogleMaps(){return this.isLoaded?window.google:this.loadPromise?this.loadPromise:(this.loadPromise=new Promise((t,a)=>{if(window.google&&window.google.maps){this.isLoaded=!0,t(window.google);return}const r=document.createElement("script");r.src=`https://maps.googleapis.com/maps/api/js?key=${this.apiKey}&libraries=places,geometry`,r.async=!0,r.defer=!0,r.onload=()=>{this.isLoaded=!0,t(window.google)},r.onerror=()=>{a(new Error("Failed to load Google Maps API"))},document.head.appendChild(r)}),this.loadPromise)}async geocodeAddress(t){try{const a=await fetch(`${this.baseUrl}/geocode/json?address=${encodeURIComponent(t)}&key=${this.apiKey}`);if(!a.ok)throw new Error(`Geocoding failed: ${a.status}`);const r=await a.json();if(r.status!=="OK"||!r.results.length)throw new Error(`No results found for: ${t}`);const n=r.results[0],o=n.geometry.location;return{latitude:o.lat,longitude:o.lng,address:n.formatted_address,components:n.address_components,placeId:n.place_id,source:"geocoding"}}catch(a){throw console.error("Geocoding error:",a),a}}async reverseGeocode(t,a){try{const r=await fetch(`${this.baseUrl}/geocode/json?latlng=${t},${a}&key=${this.apiKey}`);if(!r.ok)throw new Error(`Reverse geocoding failed: ${r.status}`);const n=await r.json();if(n.status!=="OK"||!n.results.length)throw new Error("No address found for coordinates");const o=n.results[0];return{latitude:t,longitude:a,address:o.formatted_address,components:o.address_components,placeId:o.place_id,source:"reverse_geocoding"}}catch(r){throw console.error("Reverse geocoding error:",r),r}}async geocodeZipCode(t){const a=`${t}, USA`;try{const r=await this.geocodeAddress(a);if(!r.components.some(o=>o.types.includes("postal_code")))throw new Error("Invalid ZIP code");return{...r,zipCode:t,source:"zip_code"}}catch(r){throw console.error("ZIP code geocoding error:",r),new Error(`Invalid ZIP code: ${t}`)}}async searchPlaces(t,a=null,r=5e4){try{let n=`${this.baseUrl}/place/textsearch/json?query=${encodeURIComponent(t)}&key=${this.apiKey}`;a&&(n+=`&location=${a.latitude},${a.longitude}&radius=${r}`);const o=await fetch(n);if(!o.ok)throw new Error(`Places search failed: ${o.status}`);const l=await o.json();if(l.status!=="OK")throw new Error(`Places API error: ${l.status}`);return l.results.map(h=>({placeId:h.place_id,name:h.name,address:h.formatted_address,latitude:h.geometry.location.lat,longitude:h.geometry.location.lng,rating:h.rating,types:h.types}))}catch(n){throw console.error("Places search error:",n),n}}async createMap(t,a={}){await this.loadGoogleMaps();const n={...{zoom:10,center:{lat:40.7128,lng:-74.006},mapTypeId:"roadmap",zoomControl:!0,streetViewControl:!1,fullscreenControl:!1,mapTypeControl:!1,styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}]},...a};return new window.google.maps.Map(t,n)}createMarker(t,a,r={}){const n={position:a,map:t,animation:window.google.maps.Animation.DROP};return new window.google.maps.Marker({...n,...r})}createInfoWindow(t,a={}){return new window.google.maps.InfoWindow({content:t,...a})}calculateDistance(t,a){const n=this.toRadians(a.latitude-t.latitude),o=this.toRadians(a.longitude-t.longitude),l=Math.sin(n/2)*Math.sin(n/2)+Math.cos(this.toRadians(t.latitude))*Math.cos(this.toRadians(a.latitude))*Math.sin(o/2)*Math.sin(o/2);return 6371*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))}toRadians(t){return t*(Math.PI/180)}async getCurrentLocation(t={}){return new Promise((a,r)=>{if(!navigator.geolocation){r(new Error("Geolocation not supported"));return}const n={enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5};navigator.geolocation.getCurrentPosition(async o=>{try{const{latitude:l,longitude:h,accuracy:c}=o.coords,m=await this.reverseGeocode(l,h);a({...m,accuracy:c,source:"gps"})}catch{a({latitude:o.coords.latitude,longitude:o.coords.longitude,accuracy:o.coords.accuracy,address:`${o.coords.latitude.toFixed(4)}, ${o.coords.longitude.toFixed(4)}`,source:"gps"})}},o=>{let l="Location access failed";switch(o.code){case o.PERMISSION_DENIED:l="Location access denied by user";break;case o.POSITION_UNAVAILABLE:l="Location information unavailable";break;case o.TIMEOUT:l="Location request timed out";break}r(new Error(l))},{...n,...t})})}isConfigured(){return!!this.apiKey}getFallbackLocation(t){const r={10001:{lat:40.7505,lng:-73.9934,address:"New York, NY 10001"},11218:{lat:40.6441,lng:-73.971,address:"Brooklyn, NY 11218"},90210:{lat:34.0901,lng:-118.4065,address:"Beverly Hills, CA 90210"},60601:{lat:41.8827,lng:-87.6233,address:"Chicago, IL 60601"},94102:{lat:37.7849,lng:-122.4094,address:"San Francisco, CA 94102"}}[t];if(r)return{latitude:r.lat,longitude:r.lng,address:r.address,zipCode:t,source:"fallback"};throw new Error(`Unsupported ZIP code: ${t}`)}}const R=new Ys,mt="AIzaSyB_Fj3F0vAmvCNBGMGIN90fQtk85cuxj1s",ht="https://www.googleapis.com/geolocation/v1/geolocate",be=async()=>{try{const s=await fetch(`${ht}?key=${mt}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({considerIp:!0,wifiAccessPoints:[],cellTowers:[]})});if(!s.ok)throw s.status===403?new Error("Google Geolocation API access denied. Check your API key and billing."):s.status===400?new Error("Invalid geolocation request"):new Error(`Geolocation API error: ${s.status}`);const t=await s.json();if(!t.location)throw new Error("No location data received");return{latitude:t.location.lat,longitude:t.location.lng,accuracy:t.accuracy||1e3,source:"google_geolocation",timestamp:new Date().toISOString()}}catch(s){throw console.error("Google Geolocation API error:",s),s}},xt=()=>!0,gt=async()=>{let s=[];try{const t=await fetch(`${ht}?key=${mt}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({considerIp:!0,wifiAccessPoints:s,cellTowers:[]})});if(!t.ok)throw new Error(`Enhanced geolocation failed: ${t.status}`);const a=await t.json();return{latitude:a.location.lat,longitude:a.location.lng,accuracy:a.accuracy||1e3,source:"google_geolocation_enhanced",timestamp:new Date().toISOString(),enhancedData:{wifiPointsUsed:s.length,cellTowersUsed:0}}}catch(t){return console.error("Enhanced geolocation error:",t),be()}},X={getCurrentLocation:be,getEnhancedLocation:gt,isConfigured:xt},Zs=Object.freeze(Object.defineProperty({__proto__:null,default:X,getCurrentLocation:be,getEnhancedLocation:gt,isConfigured:xt},Symbol.toStringTag,{value:"Module"})),ft=u.createContext({});function J(){const s=u.useContext(ft);if(!s)throw new Error("useLocation must be used within a LocationProvider");return s}function Qs({children:s}){const[t,a]=u.useState(null),[r,n]=u.useState(null),[o,l]=u.useState(!1),[h,c]=u.useState("prompt"),[m,g]=u.useState(null),[x,b]=u.useState(!1);u.useEffect(()=>{S(),j(),N()},[]);const S=async()=>{if(navigator.permissions&&navigator.permissions.query)try{const C=await navigator.permissions.query({name:"geolocation"});c(C.state),C.addEventListener("change",()=>{c(C.state)})}catch(C){console.warn("Permission API not supported:",C)}},j=()=>{try{const C=localStorage.getItem("crowdpollen_location");if(C){const k=JSON.parse(C),M=60*60*1e3;Date.now()-k.timestamp<M?a(k):localStorage.removeItem("crowdpollen_location")}}catch(C){console.warn("Error loading saved location:",C),localStorage.removeItem("crowdpollen_location")}},N=()=>{try{const C=localStorage.getItem("crowdpollen_use_google_geolocation");C&&b(JSON.parse(C))}catch(C){console.warn("Error loading geolocation preference:",C)}},w=u.useCallback(C=>{b(C);try{localStorage.setItem("crowdpollen_use_google_geolocation",JSON.stringify(C))}catch(k){console.warn("Error saving geolocation preference:",k)}},[]),p=u.useCallback(async()=>{l(!0),n(null);try{if(!X.isConfigured())throw new Error("Google Geolocation API not configured");const C=await X.getCurrentLocation();let k=`${C.latitude.toFixed(4)}, ${C.longitude.toFixed(4)}`;if(R.isConfigured())try{k=(await R.reverseGeocode(C.latitude,C.longitude)).address}catch(A){console.warn("Reverse geocoding failed:",A)}const M={...C,address:k,source:"google_geolocation",timestamp:Date.now()};return a(M),i(M),M}catch(C){const k=C.message||"Google Geolocation failed";throw n(k),new Error(k)}finally{l(!1)}},[]),i=C=>{try{const k={...C,timestamp:Date.now()};localStorage.setItem("crowdpollen_location",JSON.stringify(k))}catch(k){console.warn("Error saving location:",k)}},y=u.useCallback(async(C={})=>{l(!0),n(null);try{if(!R.isConfigured()){const M=await new Promise((ne,Q)=>{if(!navigator.geolocation){Q(new Error("Geolocation is not supported by your browser"));return}navigator.geolocation.getCurrentPosition(ne,Q,{enableHighAccuracy:!0,timeout:15e3,maximumAge:3e5,...C})}),{latitude:A,longitude:D,accuracy:Y}=M.coords,Z={latitude:A,longitude:D,accuracy:Y,address:`${A.toFixed(4)}, ${D.toFixed(4)}`,source:"gps",timestamp:Date.now()};return a(Z),i(Z),c("granted"),Z}const k=await R.getCurrentLocation(C);return a(k),i(k),c("granted"),k}catch(k){const M=We(k);throw n(M),k.message.includes("denied")&&c("denied"),new Error(M)}finally{l(!1)}},[]),d=u.useCallback((C={})=>{if(!navigator.geolocation)return n("Geolocation is not supported"),null;const k={enableHighAccuracy:!0,timeout:15e3,maximumAge:6e4,...C},M=navigator.geolocation.watchPosition(async A=>{try{const{latitude:D,longitude:Y,accuracy:Z}=A.coords;let ne=`${D.toFixed(4)}, ${Y.toFixed(4)}`;if(R.isConfigured())try{ne=(await R.reverseGeocode(D,Y)).address}catch(Ce){console.warn("Reverse geocoding failed:",Ce)}const Q={latitude:D,longitude:Y,accuracy:Z,address:ne,source:"gps",timestamp:Date.now()};a(Q),i(Q),n(null)}catch(D){console.error("Watch position error:",D)}},A=>{const D=We(A);n(D)},k);return g(M),M},[]),f=u.useCallback(()=>{m&&navigator.geolocation&&(navigator.geolocation.clearWatch(m),g(null))},[m]),v=u.useCallback(async C=>{l(!0),n(null);try{if(!/^\d{5}(-\d{4})?$/.test(C))throw new Error("Invalid ZIP code format");const k=C.slice(0,5);let M;R.isConfigured()?M=await R.geocodeZipCode(k):M=R.getFallbackLocation(k);const A={...M,zipCode:k,source:"zip_code",timestamp:Date.now()};return a(A),i(A),A}catch(k){const M=k.message||"Invalid ZIP code";throw n(M),new Error(M)}finally{l(!1)}},[]),P=u.useCallback(async C=>{l(!0),n(null);try{if(!R.isConfigured())throw new Error("Location search requires Google Maps API configuration");const M={...await R.geocodeAddress(C),source:"manual",timestamp:Date.now()};return a(M),i(M),M}catch(k){const M=k.message||"Unable to find location";throw n(M),new Error(M)}finally{l(!1)}},[]),_=u.useCallback(()=>{a(null),n(null),localStorage.removeItem("crowdpollen_location"),f()},[f]),I=u.useCallback(async()=>{if(t){if(t.source==="gps")return await y();if(t.source==="google_geolocation")return await p();if(t.zipCode)return await v(t.zipCode);if(t.address&&t.source==="manual")return await P(t.address)}},[t,y,p,v,P]),E=u.useCallback(async(C={})=>{if(x&&X.isConfigured())try{return await p()}catch(k){return console.warn("Google Geolocation failed, falling back to GPS:",k),await y(C)}else return await y(C)},[x,p,y]),L={location:t,error:r,isLoading:o,permissionStatus:h,requestGPSLocation:y,requestGoogleGeolocation:p,requestLocationWithPreference:E,watchPosition:d,stopWatching:f,setZipCode:v,setManualLocation:P,clearLocation:_,refreshLocation:I,hasLocation:!!t,isGPSLocation:(t==null?void 0:t.source)==="gps",isGoogleGeolocation:(t==null?void 0:t.source)==="google_geolocation",isManualLocation:(t==null?void 0:t.source)==="manual",isGoogleMapsConfigured:R.isConfigured(),isGoogleGeolocationConfigured:X.isConfigured(),useGoogleGeolocation:x,updateGeolocationPreference:w};return e.jsx(ft.Provider,{value:L,children:s})}function We(s){if(typeof s=="string")return s;if(s.code)switch(s.code){case 1:return"Location access denied. Please enable location services.";case 2:return"Location information unavailable. Please try again.";case 3:return"Location request timed out. Please try again.";default:return"Unable to get location. Please try again."}return s.message||"Unable to get location. Please try again."}const pt=u.createContext({});function yt(){const s=u.useContext(pt);if(!s)throw new Error("useNotification must be used within a NotificationProvider");return s}function Xs({children:s}){const[t,a]=u.useState([]),[r,n]=u.useState({highPollenAlerts:!0,symptomReminders:!0,weeklyReports:!1,pushNotifications:!0});u.useEffect(()=>{const j=localStorage.getItem("notification_preferences");if(j)try{n(JSON.parse(j))}catch(N){console.error("Failed to load notification preferences:",N)}},[]);const o=u.useCallback(j=>{n(N=>{const w={...N,...j};return localStorage.setItem("notification_preferences",JSON.stringify(w)),w})},[]),l=u.useCallback(j=>{const N=Date.now()+Math.random(),w={id:N,type:"info",duration:5e3,...j};return a(p=>[...p,w]),w.duration>0&&setTimeout(()=>{h(N)},w.duration),N},[]),h=u.useCallback(j=>{a(N=>N.filter(w=>w.id!==j))},[]),c=u.useCallback(()=>{a([])},[]),m=u.useCallback((j,N={})=>l({type:"success",message:j,...N}),[l]),g=u.useCallback((j,N={})=>l({type:"error",message:j,duration:8e3,...N}),[l]),x=u.useCallback((j,N={})=>l({type:"warning",message:j,...N}),[l]),b=u.useCallback((j,N={})=>l({type:"info",message:j,...N}),[l]),S={notifications:t,addNotification:l,removeNotification:h,clearAllNotifications:c,showSuccess:m,showError:g,showWarning:x,showInfo:b,preferences:r,updatePreferences:o};return e.jsxs(pt.Provider,{value:S,children:[s,e.jsx(ea,{})]})}function ea(){const{notifications:s,removeNotification:t}=yt();return s.length===0?null:e.jsx("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2 z-50 space-y-2 max-w-sm w-full px-4",children:s.map(a=>e.jsx(ta,{notification:a,onRemove:()=>t(a.id)},a.id))})}function ta({notification:s,onRemove:t}){const{type:a,message:r,title:n,action:o}=s,l=()=>{const c="relative p-4 rounded-lg shadow-lg border-l-4 bg-white";switch(a){case"success":return`${c} border-green-500`;case"error":return`${c} border-red-500`;case"warning":return`${c} border-yellow-500`;case"info":default:return`${c} border-blue-500`}},h=()=>{switch(a){case"success":return e.jsx("svg",{className:"w-5 h-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})});case"error":return e.jsx("svg",{className:"w-5 h-5 text-red-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})});case"warning":return e.jsx("svg",{className:"w-5 h-5 text-yellow-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})});case"info":default:return e.jsx("svg",{className:"w-5 h-5 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}};return e.jsxs("div",{className:`${l()} notification animate-slideDown`,children:[e.jsx("button",{onClick:t,className:"absolute top-2 right-2 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close notification",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 mr-3 mt-0.5",children:h()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[n&&e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-1",children:n}),e.jsx("p",{className:"text-sm text-gray-700",children:r}),o&&e.jsx("div",{className:"mt-3",children:e.jsx("button",{onClick:o.onClick,className:"text-sm font-medium text-blue-600 hover:text-blue-500 transition-colors",children:o.label})})]})]})]})}function sa(){const s=ue(),t=de(),a=[{id:"home",path:"/",icon:Lt,label:"Home"},{id:"camera",path:"/camera",icon:B,label:"Submit"},{id:"map",path:"/map",icon:Ve,label:"Map"},{id:"symptomLog",path:"/symptoms",icon:Et,label:"Log"},{id:"settings",path:"/settings",icon:qe,label:"Settings"}],r=n=>n==="/"?t.pathname==="/":t.pathname.startsWith(n);return e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white/95 backdrop-blur-md border-t border-gray-100 z-50 safe-area-bottom",children:e.jsx("div",{className:"max-w-mobile mx-auto",children:e.jsx("div",{className:"grid grid-cols-5 px-4 py-2",children:a.map(n=>e.jsxs("button",{onClick:()=>s(n.path),className:`flex flex-col items-center justify-center py-3 px-2 transition-colors ${r(n.path)?"text-blue-500":"text-gray-500"}`,children:[e.jsx(n.icon,{className:`w-6 h-6 mb-1 ${r(n.path)?"stroke-2":"stroke-1.5"}`}),e.jsx("span",{className:`text-xs ${r(n.path)?"font-semibold":"font-medium"}`,children:n.label})]},n.id))})})})}class we{constructor(){this.apiUrl="https://alie354-crowdpollen.hf.space/api/predict",this.defaultConfidence=.25}async analyzePollen(t,a=this.defaultConfidence){try{const r=new FormData;r.append("data",JSON.stringify([t,a]));const n=await fetch(this.apiUrl,{method:"POST",body:r});if(!n.ok)throw new Error(`API request failed: ${n.status} ${n.statusText}`);const o=await n.json();return this.parseResults(o)}catch(r){throw console.error("Error calling pollen API:",r),new Error(`Pollen analysis failed: ${r.message}`)}}parseResults(t){var a,r,n;try{const o=((a=t.data)==null?void 0:a[2])||{};return{totalPollenCount:o.total_pollen_count||0,densityLevel:this.normalizeDensityLevel(o.density_level),classBreakdown:o.class_breakdown||{},advice:o.advice||"No specific advice available",detections:o.detections||[],confidence:o.model_confidence_threshold||this.defaultConfidence,annotatedImage:(r=t.data)==null?void 0:r[0],summary:(n=t.data)==null?void 0:n[1],pollenTypes:this.extractPollenTypes(o.class_breakdown||{}),riskLevel:this.calculateRiskLevel(o.total_pollen_count||0),icon:this.getPollenIcon(o.density_level),color:this.getPollenColor(o.density_level)}}catch(o){throw console.error("Error parsing API results:",o),new Error("Failed to parse analysis results")}}normalizeDensityLevel(t){if(!t)return"Unknown";const a=t.toLowerCase().trim();return{low:"Low",moderate:"Medium",medium:"Medium",high:"High","very high":"Very High",very_high:"Very High"}[a]||t}extractPollenTypes(t){const a=[];for(const[r,n]of Object.entries(t))n>0&&a.push({name:r.replace(/^Pollen Type \d+$/,`Type ${r.split(" ").pop()}`),count:n,originalName:r});return a.sort((r,n)=>n.count-r.count)}calculateRiskLevel(t){return t===0?"None":t<=10?"Low":t<=30?"Medium":t<=60?"High":"Very High"}getPollenIcon(t){return{Low:"ðŸŒ±",Medium:"ðŸŒ¿",High:"ðŸŒ»","Very High":"ðŸŒ‹"}[this.normalizeDensityLevel(t)]||"ðŸŒ¿"}getPollenColor(t){return{Low:"#22c55e",Medium:"#f59e0b",High:"#ef4444","Very High":"#991b1b"}[this.normalizeDensityLevel(t)]||"#6b7280"}async testConnection(){try{const t=document.createElement("canvas");t.width=1,t.height=1;const a=t.getContext("2d");a.fillStyle="white",a.fillRect(0,0,1,1);const r=await new Promise(o=>{t.toBlob(o,"image/jpeg",.8)});return{success:!0,message:"API connection successful",testResult:await this.analyzePollen(r,.1)}}catch(t){return{success:!1,message:`API connection failed: ${t.message}`,error:t}}}async getLocalPollenData(t,a){try{const r=new Date,n=r.getMonth();let o="Low",l="Mixed";n>=2&&n<=5?(o="High",l="Tree"):n>=6&&n<=8?(o="Medium",l="Grass"):n>=9&&n<=10&&(o="Medium",l="Weed");const h=Math.sin(t*Math.PI/180)*.3,c=Math.cos(a*Math.PI/180)*.2,m=(h+c)*20,g={Low:15,Medium:35,High:65}[o]||25,x=Math.max(0,Math.round(g+m));return{location:{latitude:t,longitude:a,address:`${t.toFixed(4)}, ${a.toFixed(4)}`},current:{totalPollenCount:x,densityLevel:this.calculateRiskLevel(x),mainPollenType:l,lastUpdated:r.toISOString(),conditions:{temperature:Math.round(20+Math.random()*15),humidity:Math.round(40+Math.random()*40),windSpeed:Math.round(5+Math.random()*15)}},forecast:this.generateLocalForecast(t,a),advice:this.getSeasonalAdvice(n,x),icon:this.getPollenIcon(this.calculateRiskLevel(x)),color:this.getPollenColor(this.calculateRiskLevel(x))}}catch(r){throw console.error("Error fetching local pollen data:",r),r}}generateLocalForecast(t,a){const r=[],n=new Date;for(let o=1;o<=5;o++){const l=new Date(n);l.setDate(l.getDate()+o);const h=Math.random()*.4-.2,c=25+Math.sin(t*Math.PI/180)*15,m=Math.max(0,Math.round(c*(1+h)));r.push({date:l.toISOString().split("T")[0],totalPollenCount:m,densityLevel:this.calculateRiskLevel(m),mainType:this.getSeasonalMainType(l.getMonth()),conditions:{temperature:Math.round(18+Math.random()*20),humidity:Math.round(35+Math.random()*50),windSpeed:Math.round(3+Math.random()*20)}})}return r}getSeasonalMainType(t){return t>=2&&t<=5?"Tree":t>=6&&t<=8?"Grass":t>=9&&t<=10?"Weed":"Mixed"}getSeasonalAdvice(t,a){let r="";return t>=2&&t<=5?r="Spring tree pollen season is active. ":t>=6&&t<=8?r="Summer grass pollen season. ":t>=9&&t<=10?r="Fall weed pollen season. ":r="Winter season - generally lower pollen levels. ",a>50?r+="High pollen levels detected. Consider staying indoors during peak hours and taking allergy medication if needed.":a>25?r+="Moderate pollen levels. Sensitive individuals should take precautions.":r+="Low pollen levels. Good conditions for outdoor activities.",r}async getNationalPollenData(){try{return{nationalAverage:"Medium",regions:[{name:"Northeast",level:"High",count:45},{name:"Southeast",level:"Very High",count:78},{name:"Midwest",level:"Medium",count:32},{name:"Southwest",level:"Low",count:15},{name:"West",level:"Medium",count:28}],lastUpdated:new Date().toISOString(),trend:"increasing"}}catch(t){throw console.error("Error fetching national pollen data:",t),t}}getFormattedAdvice(t){const{totalPollenCount:a,densityLevel:r,pollenTypes:n}=t;let o=t.advice;if(a>30&&(o+=`

â€¢ Consider staying indoors during peak hours (10 AM - 4 PM)`,o+=`
â€¢ Keep windows closed and use air conditioning`),n.length>0){const l=n[0].name;o+=`
â€¢ Primary pollen type detected: ${l}`}return(r==="High"||r==="Very High")&&(o+=`
â€¢ Take allergy medication if prescribed`,o+=`
â€¢ Shower and change clothes after being outside`),o}}window.CrowdPollenAPI=we;window.crowdPollenAPI=new we;const G=new we,vt="https://pollen.googleapis.com/v1",bt="AIzaSyB_Fj3F0vAmvCNBGMGIN90fQtk85cuxj1s",je=6*60*60*1e3,z=new Map,wt=(s,t,a)=>{const r=Math.round(s*1e3)/1e3,n=Math.round(t*1e3)/1e3;return`forecast_${r}_${n}_${a}`},Ne=s=>s&&Date.now()-s.timestamp<je,aa=async(s,t={},a=3)=>{const r={method:"GET",headers:{"Content-Type":"application/json",...t.headers},...t};for(let n=0;n<a;n++)try{const o=await fetch(s,r);if(!o.ok){if(o.status===429){const l=Math.pow(2,n)*1e3;await new Promise(h=>setTimeout(h,l));continue}throw o.status===403?new Error("Google Pollen API access denied. Check your API key and billing."):o.status===404?new Error("No pollen data available for this location"):new Error(`API request failed: ${o.status} ${o.statusText}`)}return await o.json()}catch(o){if(n===a-1)throw o;const l=Math.pow(2,n)*1e3;await new Promise(h=>setTimeout(h,l))}},jt=async(s,t,a=3,r="en")=>{if(!s||!t)throw new Error("Latitude and longitude are required");if(a<1||a>5)throw new Error("Days must be between 1 and 5");const n=wt(s,t,a),o=z.get(n);if(Ne(o))return console.log("Returning cached forecast data"),o.data;try{const l=new URL(`${vt}/forecast:lookup`);l.searchParams.append("key",bt),l.searchParams.append("location.latitude",s.toString()),l.searchParams.append("location.longitude",t.toString()),l.searchParams.append("days",a.toString()),l.searchParams.append("languageCode",r),console.log("Fetching forecast from Google Pollen API:",{latitude:s,longitude:t,days:a});const h=await aa(l.toString()),c=ra(h);return z.set(n,{data:c,timestamp:Date.now()}),c}catch(l){return console.error("Failed to fetch pollen forecast:",l),console.log("Returning mock data as fallback"),ua(s,t,a)}},ra=s=>{if(!s||!s.dailyInfo)throw new Error("Invalid forecast data received");return{regionCode:s.regionCode,dailyForecasts:s.dailyInfo.map(t=>{var a,r,n,o,l,h,c,m,g,x,b,S,j,N,w,p,i,y,d,f,v,P,_,I;return{date:t.date,pollenTypes:{tree:{index:((n=(r=(a=t.pollenTypeInfo)==null?void 0:a.find(E=>E.code==="TREE"))==null?void 0:r.indexInfo)==null?void 0:n.value)||0,category:((h=(l=(o=t.pollenTypeInfo)==null?void 0:o.find(E=>E.code==="TREE"))==null?void 0:l.indexInfo)==null?void 0:h.category)||"UNSPECIFIED",displayName:((m=(c=t.pollenTypeInfo)==null?void 0:c.find(E=>E.code==="TREE"))==null?void 0:m.displayName)||"Tree Pollen"},grass:{index:((b=(x=(g=t.pollenTypeInfo)==null?void 0:g.find(E=>E.code==="GRASS"))==null?void 0:x.indexInfo)==null?void 0:b.value)||0,category:((N=(j=(S=t.pollenTypeInfo)==null?void 0:S.find(E=>E.code==="GRASS"))==null?void 0:j.indexInfo)==null?void 0:N.category)||"UNSPECIFIED",displayName:((p=(w=t.pollenTypeInfo)==null?void 0:w.find(E=>E.code==="GRASS"))==null?void 0:p.displayName)||"Grass Pollen"},weed:{index:((d=(y=(i=t.pollenTypeInfo)==null?void 0:i.find(E=>E.code==="WEED"))==null?void 0:y.indexInfo)==null?void 0:d.value)||0,category:((P=(v=(f=t.pollenTypeInfo)==null?void 0:f.find(E=>E.code==="WEED"))==null?void 0:v.indexInfo)==null?void 0:P.category)||"UNSPECIFIED",displayName:((I=(_=t.pollenTypeInfo)==null?void 0:_.find(E=>E.code==="WEED"))==null?void 0:I.displayName)||"Weed Pollen"}},plantInfo:t.plantInfo||[],healthRecommendations:t.healthRecommendations||[]}}),metadata:{fetchedAt:new Date().toISOString(),source:"google_pollen_api",cacheExpiry:new Date(Date.now()+je).toISOString()}}},na=(s,t,a,r)=>{const n=["TREE_UPI","GRASS_UPI","WEED_UPI"];if(!n.includes(s))throw new Error(`Invalid map type. Must be one of: ${n.join(", ")}`);const o=new URL(`${vt}/mapTypes/${s}/heatmapTiles/${t}/${a}/${r}`);return o.searchParams.append("key",bt),o.toString()},oa=async()=>{try{return await jt(40.7128,-74.006,1),!0}catch(s){return console.error("API key validation failed:",s),!1}},la=(s,t,a=3)=>{const r=wt(s,t,a),n=z.get(r);return Ne(n)?n.data:null},ia=()=>{z.clear(),console.log("Google Pollen API cache cleared")},ca=()=>{let s=0,t=0;for(const[a,r]of z.entries())Ne(r)?s++:t++;return{totalEntries:z.size,validEntries:s,expiredEntries:t,cacheHitRate:s/Math.max(z.size,1)}},oe=s=>({UNSPECIFIED:"unknown",VERY_LOW:"very_low",LOW:"low",MODERATE:"moderate",HIGH:"high",VERY_HIGH:"very_high"})[s]||"unknown",da=s=>{var h,c,m;const t=["very_low","low","moderate","high","very_high"],a={very_low:1,low:2,moderate:3,high:4,very_high:5,unknown:0},r=oe((h=s.tree)==null?void 0:h.category),n=oe((c=s.grass)==null?void 0:c.category),o=oe((m=s.weed)==null?void 0:m.category),l=Math.max(a[r]||0,a[n]||0,a[o]||0);return t[l-1]||"unknown"},ua=(s,t,a)=>{const r=["VERY_LOW","LOW","MODERATE","HIGH","VERY_HIGH"],n=[];for(let o=0;o<a;o++){const l=new Date;l.setDate(l.getDate()+o);const h=l.getMonth();let c,m,g;h>=2&&h<=4?(c=r[3+Math.floor(Math.random()*2)],m=r[1+Math.floor(Math.random()*2)],g=r[Math.floor(Math.random()*2)]):h>=5&&h<=7?(c=r[Math.floor(Math.random()*3)],m=r[3+Math.floor(Math.random()*2)],g=r[1+Math.floor(Math.random()*2)]):h>=8&&h<=10?(c=r[Math.floor(Math.random()*2)],m=r[Math.floor(Math.random()*3)],g=r[3+Math.floor(Math.random()*2)]):(c=r[Math.floor(Math.random()*2)],m=r[Math.floor(Math.random()*2)],g=r[Math.floor(Math.random()*2)]),n.push({date:l.toISOString().split("T")[0],pollenTypes:{tree:{index:r.indexOf(c)+1,category:c,displayName:"Tree Pollen"},grass:{index:r.indexOf(m)+1,category:m,displayName:"Grass Pollen"},weed:{index:r.indexOf(g)+1,category:g,displayName:"Weed Pollen"}},plantInfo:[{displayName:"Oak",inSeason:h>=2&&h<=4},{displayName:"Birch",inSeason:h>=2&&h<=4},{displayName:"Timothy Grass",inSeason:h>=5&&h<=7},{displayName:"Ragweed",inSeason:h>=8&&h<=10}].filter(x=>x.inSeason),healthRecommendations:["Check pollen forecasts daily","Keep windows closed during high pollen days","Consider wearing sunglasses outdoors"]})}return{regionCode:"US",dailyForecasts:n,metadata:{fetchedAt:new Date().toISOString(),source:"mock_data",cacheExpiry:new Date(Date.now()+je).toISOString()}}},ma=()=>!0,le={getForecast:jt,getHeatmapTileUrl:na,validateApiKey:oa,getCachedForecast:la,clearCache:ia,getCacheStats:ca,convertCategoryToLevel:oe,getOverallPollenLevel:da,isConfigured:ma};function ha(){var w,p,i,y;const{location:s}=J(),[t,a]=u.useState(null),[r,n]=u.useState(!0),[o,l]=u.useState(null),[h,c]=u.useState(0);u.useEffect(()=>{m()},[s]);const m=async()=>{if(!(s!=null&&s.latitude)||!(s!=null&&s.longitude)){n(!1);return}try{if(n(!0),l(null),!void 0){console.warn("Google Pollen API key not configured, showing demo data");const f=g(s);a(f)}}catch(d){console.error("Failed to load forecast:",d);{const f=g(s);a(f),l(null)}}finally{n(!1)}},g=d=>{const f=new Date,v=[],P=["low","moderate","high","moderate","low"],_=["tree","grass","weed"];for(let I=0;I<5;I++){const E=new Date(f);E.setDate(E.getDate()+I);const L=P[I],C={};_.forEach(k=>{const M=Math.random()*.4-.2,D=Math.max(1,Math.min(5,Math.round((L==="low"?2:L==="moderate"?3:L==="high"?4:2)+M)));C[k]={category:L.toUpperCase(),index:D,displayName:k.charAt(0).toUpperCase()+k.slice(1)}}),v.push({date:E.toISOString().split("T")[0],pollenTypes:C,confidence:.85+Math.random()*.1,dataSource:"demo",submissionCount:Math.floor(Math.random()*20),userDataInfluence:Math.floor(Math.random()*30),healthRecommendations:[L==="high"?"Consider limiting outdoor time":"Good day for outdoor activities","Take allergy medication if needed","Keep windows closed during peak hours"]})}return{dailyForecasts:v,metadata:{enhanced:!1,fetchedAt:new Date().toISOString(),location:d.address||`${d.latitude}, ${d.longitude}`,source:"demo"}}},x=d=>{const f={very_low:{color:"#34C759",emoji:"ðŸŸ¢",description:"Very Low",advice:"Perfect day to be outside"},low:{color:"#34C759",emoji:"ðŸŸ¢",description:"Low",advice:"Great conditions for outdoor activities"},moderate:{color:"#FF9500",emoji:"ðŸŸ¡",description:"Moderate",advice:"Good day for most activities"},high:{color:"#FF3B30",emoji:"ðŸŸ ",description:"High",advice:"Consider limiting outdoor time"},very_high:{color:"#FF3B30",emoji:"ðŸ”´",description:"Very High",advice:"Stay indoors if possible"},unknown:{color:"#8E8E93",emoji:"âšª",description:"Unknown",advice:"No data available"}};return f[d]||f.unknown},b=(d,f=!1)=>{const v=new Date(d),P=new Date,_=new Date(P);return _.setDate(_.getDate()+1),v.toDateString()===P.toDateString()?"Today":v.toDateString()===_.toDateString()?"Tomorrow":f?v.toLocaleDateString("en-US",{weekday:"short"}):v.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})};if(!(s!=null&&s.latitude)||!(s!=null&&s.longitude))return e.jsx("div",{className:"bg-white rounded-xl p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(O,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Location Required"}),e.jsx("p",{className:"text-gray-600",children:"Set your location to see pollen forecast"})]})});if(r)return e.jsx("div",{className:"bg-white rounded-xl p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-32 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-24 mb-6"}),e.jsx("div",{className:"h-16 bg-gray-200 rounded mb-6"}),e.jsx("div",{className:"flex space-x-4",children:[...Array(5)].map((d,f)=>e.jsx("div",{className:"flex-1 h-12 bg-gray-200 rounded"},f))})]})});if(o)return e.jsx("div",{className:"bg-white rounded-xl p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(xe,{className:"w-12 h-12 text-red-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Forecast Unavailable"}),e.jsx("p",{className:"text-gray-600 mb-4",children:o}),e.jsx("button",{onClick:m,className:"px-4 py-2 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600 transition-colors",children:"Try Again"})]})});if(!((w=t==null?void 0:t.dailyForecasts)!=null&&w.length))return e.jsx("div",{className:"bg-white rounded-xl p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Data Available"}),e.jsx("p",{className:"text-gray-600",children:"No forecast data for this location"})]})});const S=t.dailyForecasts[h],j=le.getOverallPollenLevel(S.pollenTypes),N=x(j);return e.jsxs("div",{className:"bg-white rounded-xl p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-1",children:"Pollen Forecast"}),e.jsx("p",{className:"text-sm text-gray-600",children:((p=s.address)==null?void 0:p.split(",")[0])||"Your location"})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:b(S.date)}),e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("span",{className:"text-2xl mr-3",children:N.emoji}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:N.description}),e.jsx("div",{className:"text-gray-600",children:N.advice})]})]})]}),e.jsx("div",{className:"grid grid-cols-3 gap-4 mb-4",children:Object.entries(S.pollenTypes).map(([d,f])=>{const v=le.convertCategoryToLevel(f.category),P=x(v);return e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 mb-1 capitalize",children:d}),e.jsx("div",{className:"w-4 h-4 rounded-full mx-auto mb-1",style:{backgroundColor:P.color}}),e.jsx("div",{className:"text-xs text-gray-600",children:P.description})]},d)})}),((i=S.healthRecommendations)==null?void 0:i.length)>0&&e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsx("div",{className:"space-y-1",children:S.healthRecommendations.slice(0,2).map((d,f)=>e.jsxs("div",{className:"text-sm text-gray-700",children:["â€¢ ",d]},f))})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"5-Day Forecast"}),e.jsx("div",{className:"grid grid-cols-5 gap-2",children:t.dailyForecasts.map((d,f)=>{const v=le.getOverallPollenLevel(d.pollenTypes),P=x(v),_=f===h;return e.jsxs("button",{onClick:()=>c(f),className:`p-3 rounded-lg text-center transition-all ${_?"bg-blue-50 border border-blue-200":"hover:bg-gray-50"}`,children:[e.jsx("div",{className:"text-xs font-medium text-gray-600 mb-2",children:b(d.date,!0)}),e.jsx("div",{className:"mb-2",children:e.jsx("span",{className:"text-lg",children:P.emoji})}),e.jsx("div",{className:"text-xs text-gray-700 font-medium",children:P.description})]},f)})})]}),e.jsx("div",{className:"pt-4 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[S.confidence&&e.jsxs("span",{children:["Confidence: ",Math.round(S.confidence*100),"%"]}),((y=t.metadata)==null?void 0:y.source)==="demo"&&e.jsx("span",{className:"text-orange-600",children:"Demo Mode"})]}),e.jsx("span",{children:"Google Pollen API"})]})})]})}function xa(){var S,j;const s=ue(),{user:t}=re(),{location:a}=J(),[r,n]=u.useState(null),[o,l]=u.useState(!0),[h,c]=u.useState(null);u.useEffect(()=>{m()},[a]);const m=async()=>{try{if(l(!0),c(null),!G.getLocalPollenData)throw console.error("getLocalPollenData function not found on crowdPollenAPI:",Object.keys(G)),new Error("API function not available - please refresh the page");if(a){const N=await G.getLocalPollenData(a.latitude,a.longitude);n(N)}else{const N=await G.getNationalPollenData();n(N)}}catch(N){console.error("Failed to load pollen data:",N),c(N.message||"Unable to load pollen data");const w=new Date,p=w.getMonth();let i="moderate",y=25,d="Mixed";p>=2&&p<=5?(i="high",y=45,d="Tree"):p>=6&&p<=8?(i="moderate",y=30,d="Grass"):p>=9&&p<=10&&(i="moderate",y=35,d="Weed"),n({current_level:i,count:y,trend:"stable",forecast:`${i.charAt(0).toUpperCase()+i.slice(1)} ${d.toLowerCase()} pollen levels expected`,last_updated:w.toISOString(),local_reports:a?12:156,current:{totalPollenCount:y,densityLevel:i.charAt(0).toUpperCase()+i.slice(1),mainPollenType:d}})}finally{l(!1)}},g=N=>{const w={very_low:{color:"#34C759",emoji:"ðŸŸ¢",description:"Very Low",advice:"Perfect day to be outside"},low:{color:"#34C759",emoji:"ðŸŸ¢",description:"Low",advice:"Great conditions for outdoor activities"},moderate:{color:"#FF9500",emoji:"ðŸŸ¡",description:"Moderate",advice:"Good day for most activities"},high:{color:"#FF3B30",emoji:"ðŸŸ ",description:"High",advice:"Consider limiting outdoor time"},very_high:{color:"#FF3B30",emoji:"ðŸ”´",description:"Very High",advice:"Stay indoors if possible"}};return w[N]||w.moderate},x=N=>{const w=new Date(N),i=Math.floor((new Date-w)/(1e3*60*60));return i<1?"Just updated":i===1?"1 hour ago":i<24?`${i} hours ago`:w.toLocaleDateString()};if(o)return e.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-gray-300 border-t-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading pollen data..."})]})});const b=g((r==null?void 0:r.current_level)||"moderate");return e.jsxs("div",{className:"min-h-screen bg-white pb-20",children:[e.jsxs("div",{className:"px-6 pt-12 pb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:t?`Hello, ${((S=t.display_name)==null?void 0:S.split(" ")[0])||"there"}`:"CrowdPollen"}),e.jsx("p",{className:"text-gray-600 mt-1",children:a?((j=a.address)==null?void 0:j.split(",")[0])||"Your location":"Set your location"})]}),e.jsx("button",{onClick:()=>s("/settings"),className:"w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center hover:bg-gray-200 transition-colors",children:t?e.jsx("span",{className:"text-lg font-medium text-gray-700",children:(t.display_name||t.email||"U")[0].toUpperCase()}):e.jsx(Ke,{className:"w-5 h-5 text-gray-600"})})]}),!a&&e.jsx("div",{className:"bg-blue-50 rounded-xl p-4 mb-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(At,{className:"w-5 h-5 text-blue-600 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-900 font-medium",children:"Location Required"}),e.jsx("p",{className:"text-blue-700 text-sm",children:"Set your location for personalized pollen data"})]})]})})]}),e.jsxs("div",{className:"px-6 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-3xl mr-4",children:b.emoji}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:b.description}),e.jsxs("p",{className:"text-gray-600",children:[(r==null?void 0:r.count)||0," grains/mÂ³"]})]})]})}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-gray-700 font-medium",children:b.advice})}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[e.jsxs("span",{children:[(r==null?void 0:r.local_reports)||0," local reports"]}),e.jsx("span",{children:x((r==null?void 0:r.last_updated)||new Date().toISOString())})]})]}),e.jsx(ha,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>s("/camera"),className:"bg-blue-500 text-white p-4 rounded-xl font-medium flex items-center justify-center space-x-3 hover:bg-blue-600 transition-colors",children:[e.jsx(B,{className:"w-5 h-5"}),e.jsx("span",{children:"Submit Reading"})]}),e.jsxs("button",{onClick:()=>s("/map"),className:"bg-white border border-gray-200 text-gray-900 p-4 rounded-xl font-medium flex items-center justify-center space-x-3 hover:bg-gray-50 transition-colors",children:[e.jsx(Ve,{className:"w-5 h-5"}),e.jsx("span",{children:"View Map"})]})]}),((r==null?void 0:r.current_level)==="high"||(r==null?void 0:r.current_level)==="very_high")&&e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(xe,{className:"w-5 h-5 text-orange-600 mr-3 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-orange-900 mb-2",children:"High Pollen Alert"}),e.jsx("p",{className:"text-sm text-orange-800 mb-3",children:"Consider taking allergy medication and limiting outdoor activities. Keep windows closed and use air conditioning when possible."}),e.jsx("button",{onClick:()=>s("/symptoms"),className:"text-sm text-orange-700 font-medium hover:text-orange-800",children:"Log your symptoms â†’"})]})]})}),h&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(xe,{className:"w-5 h-5 text-red-600 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-red-800 mb-2",children:h}),e.jsx("button",{onClick:m,className:"text-sm text-red-700 font-medium hover:text-red-800",children:"Try again"})]})]})}),t&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Your Activity"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Last submission"}),e.jsx("span",{className:"font-medium text-gray-900",children:"2 days ago"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Total submissions"}),e.jsx("span",{className:"font-medium text-gray-900",children:"12"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Current streak"}),e.jsx("span",{className:"font-medium text-gray-900",children:"5 days ðŸ”¥"})]})]}),e.jsx("button",{onClick:()=>s("/history"),className:"w-full mt-4 py-3 text-blue-600 font-medium hover:text-blue-700 transition-colors",children:"View full history"})]})]})]})}function ga({onCapture:s,onClose:t}){const a=u.useRef(null),r=u.useRef(null),n=u.useRef(null),[o,l]=u.useState(!1),[h,c]=u.useState(null),[m,g]=u.useState("environment"),[x,b]=u.useState(!1),[S,j]=u.useState(!1),N=u.useCallback(async()=>{try{n.current&&n.current.getTracks().forEach(v=>v.stop());const d={video:{facingMode:m,width:{ideal:1920,max:1920},height:{ideal:1080,max:1080}}},f=await navigator.mediaDevices.getUserMedia(d);a.current&&(a.current.srcObject=f,n.current=f,l(!0),c(!0))}catch(d){console.error("Camera access denied:",d),c(!1)}},[m]),w=u.useCallback(()=>{n.current&&(n.current.getTracks().forEach(d=>d.stop()),n.current=null,l(!1))},[]),p=u.useCallback(()=>{g(d=>d==="environment"?"user":"environment")},[]),i=u.useCallback(async()=>{if(n.current){const d=n.current.getVideoTracks()[0];if(d&&d.getCapabilities&&d.getCapabilities().torch)try{await d.applyConstraints({advanced:[{torch:!x}]}),b(!x)}catch(v){console.warn("Flash not supported:",v)}}},[x]),y=u.useCallback(async()=>{if(!(!a.current||!r.current||S)){j(!0);try{const d=a.current,f=r.current,v=f.getContext("2d");f.width=d.videoWidth,f.height=d.videoHeight,v.drawImage(d,0,0);const P=await new Promise(_=>{f.toBlob(_,"image/jpeg",.9)});if(P){const _=document.createElement("div");_.className="fixed inset-0 bg-white z-50 pointer-events-none",_.style.animation="flash 0.2s ease-out",document.body.appendChild(_),setTimeout(()=>{document.body.removeChild(_)},200),s(P),w()}}catch(d){console.error("Capture error:",d)}finally{j(!1)}}},[s,w,S]);return u.useEffect(()=>(N(),()=>w()),[N,w]),u.useEffect(()=>{const d=document.createElement("style");return d.textContent=`
      @keyframes flash {
        0% { opacity: 0; }
        50% { opacity: 0.8; }
        100% { opacity: 0; }
      }
    `,document.head.appendChild(d),()=>document.head.removeChild(d)},[]),h===!1?e.jsx("div",{className:"fixed inset-0 bg-black flex items-center justify-center p-6 z-50",children:e.jsx("div",{className:"bg-white rounded-xl p-6 max-w-sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(Pe,{className:"w-8 h-8 text-red-600"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Camera Access Required"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Please allow camera access to take photos of your pollen trap."}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:N,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-medium",children:"Try Again"}),e.jsx("button",{onClick:t,className:"w-full bg-gray-200 text-gray-800 py-3 rounded-lg font-medium",children:"Close"})]})]})})}):e.jsxs("div",{className:"fixed inset-0 bg-black z-50",children:[e.jsxs("div",{className:"absolute top-0 left-0 right-0 z-10 p-4 flex justify-between items-center safe-area-top",children:[e.jsx("button",{onClick:t,className:"bg-black/50 text-white p-3 rounded-full backdrop-blur-sm",children:e.jsx(Pe,{className:"w-6 h-6"})}),e.jsx("div",{className:"bg-black/70 text-white px-4 py-2 rounded-full text-sm backdrop-blur-sm",children:"Center trap in frame"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:i,className:"bg-black/50 text-white p-3 rounded-full backdrop-blur-sm",children:x?e.jsx(Tt,{className:"w-6 h-6"}):e.jsx(Dt,{className:"w-6 h-6"})}),e.jsx("button",{onClick:p,className:"bg-black/50 text-white p-3 rounded-full backdrop-blur-sm",children:e.jsx(Rt,{className:"w-6 h-6"})})]})]}),e.jsx("video",{ref:a,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 pointer-events-none",children:e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"relative w-64 h-64",children:[e.jsx("div",{className:"absolute top-0 left-0 w-12 h-12 border-t-4 border-l-4 border-white rounded-tl-lg opacity-80"}),e.jsx("div",{className:"absolute top-0 right-0 w-12 h-12 border-t-4 border-r-4 border-white rounded-tr-lg opacity-80"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-12 h-12 border-b-4 border-l-4 border-white rounded-bl-lg opacity-80"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-12 h-12 border-b-4 border-r-4 border-white rounded-br-lg opacity-80"}),e.jsxs("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:[e.jsx("div",{className:"w-8 h-0.5 bg-white opacity-60"}),e.jsx("div",{className:"w-0.5 h-8 bg-white opacity-60 absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"})]})]})})}),e.jsx("div",{className:"absolute bottom-32 left-1/2 transform -translate-x-1/2 pointer-events-none",children:e.jsx("div",{className:"bg-white/90 p-4 rounded-lg backdrop-blur-sm max-w-xs",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"relative w-32 h-20 bg-yellow-50 rounded mb-2 mx-auto",children:[...Array(6)].map((d,f)=>e.jsx("div",{className:"absolute w-2 h-2 bg-yellow-600 rounded-full animate-pulse",style:{animationDelay:`${f*.5}s`,top:`${20+Math.random()*40}%`,left:`${10+Math.random()*80}%`}},f))}),e.jsx("p",{className:"text-xs text-gray-700 font-medium",children:"Pollen grains will look like yellow dots"})]})})}),e.jsx("div",{className:"absolute bottom-8 left-1/2 transform -translate-x-1/2 safe-area-bottom",children:e.jsxs("button",{onClick:y,disabled:!o||S,className:"relative w-20 h-20 bg-white rounded-full shadow-lg disabled:opacity-50 transition-all duration-200 active:scale-95",children:[e.jsx("div",{className:`absolute inset-2 bg-white rounded-full border-4 transition-colors ${S?"border-blue-500":"border-gray-300"}`}),S&&e.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-blue-500 animate-ping"})]})}),e.jsx("canvas",{ref:r,className:"hidden"})]})}function Nt({onLocationSet:s,showTitle:t=!0}){var i,y;const{location:a,isLoading:r,error:n,requestGPSLocation:o,setZipCode:l,clearLocation:h,permissionStatus:c}=J(),[m,g]=u.useState(""),[x,b]=u.useState("gps"),S=async()=>{try{const d=await o();s&&s(d)}catch(d){console.error("GPS location failed:",d)}},j=async d=>{if(d.preventDefault(),m.length===5)try{const f=await l(m);s&&s(f)}catch(f){console.error("ZIP code failed:",f)}},N=d=>{const f=d.target.value.replace(/\D/g,"").slice(0,5);g(f)},w=()=>r&&x==="gps"?"Getting location...":c==="denied"?"Location denied":(a==null?void 0:a.source)==="gps"?"Update GPS":"Use GPS",p=()=>r||c==="denied";return e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-4",children:[t&&e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"font-semibold flex items-center",children:[e.jsx(O,{className:"w-5 h-5 mr-2 text-blue-600"}),"Set Your Location"]}),a&&e.jsx("button",{onClick:h,className:"text-sm text-gray-500 hover:text-gray-700",children:"Clear"})]}),e.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1 mb-4",children:[e.jsxs("button",{onClick:()=>b("gps"),className:`flex-1 py-2 px-3 rounded-md text-sm font-medium transition-colors ${x==="gps"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(_e,{className:"w-4 h-4 inline mr-1"}),"GPS"]}),e.jsx("button",{onClick:()=>b("zip"),className:`flex-1 py-2 px-3 rounded-md text-sm font-medium transition-colors ${x==="zip"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"ZIP Code"})]}),x==="gps"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:S,disabled:p(),className:`w-full py-3 px-4 rounded-lg font-medium flex items-center justify-center transition-colors ${p()?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:[r&&x==="gps"?e.jsx(Ie,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(_e,{className:"w-4 h-4 mr-2"}),w()]}),c==="denied"&&e.jsxs("div",{className:"text-sm text-amber-600 bg-amber-50 p-3 rounded-lg",children:[e.jsx("p",{className:"font-medium",children:"Location access denied"}),e.jsx("p",{children:"Please enable location services in your browser settings or use ZIP code instead."})]})]}),x==="zip"&&e.jsxs("form",{onSubmit:j,className:"space-y-3",children:[e.jsx("div",{children:e.jsx("input",{type:"text",placeholder:"Enter ZIP code (e.g., 90210)",value:m,onChange:N,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",maxLength:5})}),e.jsxs("button",{type:"submit",disabled:m.length!==5||r&&x==="zip",className:"w-full py-3 px-4 bg-blue-600 text-white rounded-lg font-medium disabled:opacity-50 disabled:cursor-not-allowed hover:bg-blue-700 transition-colors flex items-center justify-center",children:[r&&x==="zip"?e.jsx(Ie,{className:"w-4 h-4 mr-2 animate-spin"}):null,"Set Location"]})]}),n&&e.jsx("div",{className:"mt-3 text-sm text-red-600 bg-red-50 p-3 rounded-lg",children:n}),a&&e.jsx("div",{className:"mt-4 p-3 bg-green-50 rounded-lg",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(O,{className:"w-4 h-4 text-green-600 mr-2 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-green-800",children:"Location set"}),e.jsx("p",{className:"text-sm text-green-700 truncate",children:a.address||`${(i=a.latitude)==null?void 0:i.toFixed(4)}, ${(y=a.longitude)==null?void 0:y.toFixed(4)}`}),a.source==="gps"&&a.accuracy&&e.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["Accuracy: Â±",Math.round(a.accuracy),"m"]})]})]})}),e.jsx("div",{className:"mt-4 text-xs text-gray-500",children:e.jsx("p",{children:"Your location helps us show relevant pollen data for your area. GPS provides more accurate results."})})]})}function fa({setScreen:s}){var y,d,f;const{user:t}=re(),{location:a}=J(),[r,n]=u.useState(!1),[o,l]=u.useState(!1),[h,c]=u.useState(!1),[m,g]=u.useState(null),[x,b]=u.useState(null),S=async v=>{try{if(c(!0),n(!1),b(URL.createObjectURL(v)),!a){l(!0);return}await j(v,a)}catch(P){console.error("Capture error:",P),c(!1)}},j=async(v,P)=>{try{c(!0);const _=await G.submitPollenReading({image:v,location:P,user_id:(t==null?void 0:t.id)||null,timestamp:new Date().toISOString()});g(_)}catch(_){console.error("Processing error:",_),g({id:"demo-"+Date.now(),pollen_density:"moderate",pollen_count:Math.floor(Math.random()*50)+10,confidence_score:.75+Math.random()*.2,plant_species:["Oak","Birch","Grass"],advice:"Moderate pollen levels detected. Sensitive individuals may experience mild symptoms.",weather_conditions:{temperature:22,humidity:65,wind_speed:8}})}finally{c(!1)}},N=async v=>{if(l(!1),x){const _=await(await fetch(x)).blob();await j(_,v)}},w=()=>{g(null),b(null),n(!0)},p=()=>{g(null),b(null),n(!1)},i=v=>{const P={very_low:{color:"text-green-600",bg:"bg-green-50",emoji:"ðŸŸ¢"},low:{color:"text-green-600",bg:"bg-green-50",emoji:"ðŸŸ¢"},moderate:{color:"text-yellow-600",bg:"bg-yellow-50",emoji:"ðŸŸ¡"},high:{color:"text-orange-600",bg:"bg-orange-50",emoji:"ðŸŸ "},very_high:{color:"text-red-600",bg:"bg-red-50",emoji:"ðŸ”´"}};return P[v]||P.moderate};if(r)return e.jsx(ga,{onCapture:S,onClose:()=>n(!1)});if(o)return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-sm w-full",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Location Required"}),e.jsx("p",{className:"text-gray-600 mb-4 text-sm",children:"We need your location to provide accurate pollen data for your area."}),e.jsx(Nt,{onLocationSet:N,showTitle:!1}),e.jsx("button",{onClick:()=>{l(!1),c(!1),b(null)},className:"w-full mt-4 py-2 text-gray-600 text-sm",children:"Cancel"})]})});if(h)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center max-w-sm",children:[x&&e.jsx("div",{className:"mb-6",children:e.jsx("img",{src:x,alt:"Captured pollen trap",className:"w-48 h-48 object-cover rounded-xl mx-auto shadow-lg"})}),e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Analyzing Pollen Levels"}),e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"Our AI is counting pollen grains and identifying species..."}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-3",children:e.jsx("p",{className:"text-blue-800 text-xs",children:"This usually takes 10-30 seconds"})})]})});if(m){const v=i(m.pollen_density);return e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-20",children:[e.jsx("div",{className:"bg-white shadow-sm p-4 safe-area-top",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>s("home"),className:"mr-3 p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(q,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl font-semibold",children:"Pollen Analysis Results"})]})}),e.jsxs("div",{className:"p-4 space-y-4",children:[x&&e.jsx("div",{className:"bg-white rounded-xl shadow-md p-4",children:e.jsx("img",{src:x,alt:"Analyzed pollen trap",className:"w-full h-48 object-cover rounded-lg"})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-2xl mr-3",children:v.emoji}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold capitalize",children:[m.pollen_density.replace("_"," ")," Level"]}),e.jsxs("p",{className:"text-gray-600",children:[m.pollen_count," grains detected"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Confidence"}),e.jsxs("div",{className:"text-lg font-semibold",children:[Math.round(m.confidence_score*100),"%"]})]})]}),e.jsx("div",{className:`p-4 rounded-lg ${v.bg}`,children:e.jsx("p",{className:`text-sm ${v.color} font-medium`,children:m.advice})})]}),m.plant_species&&m.plant_species.length>0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-4",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Detected Species"}),e.jsx("div",{className:"space-y-2",children:m.plant_species.map((P,_)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:P}),e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${Math.random()*60+20}%`}})})]},_))})]}),m.weather_conditions&&e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-4",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center",children:[e.jsx(Ot,{className:"w-4 h-4 mr-2"}),"Weather Conditions"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-semibold",children:[m.weather_conditions.temperature,"Â°C"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Temperature"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-semibold",children:[m.weather_conditions.humidity,"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Humidity"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-semibold",children:[m.weather_conditions.wind_speed," km/h"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Wind"})]})]})]}),a&&e.jsx("div",{className:"bg-white rounded-xl shadow-md p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(O,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:a.address||`${(y=a.latitude)==null?void 0:y.toFixed(4)}, ${(d=a.longitude)==null?void 0:d.toFixed(4)}`})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>s("map"),className:"w-full py-3 bg-blue-600 text-white rounded-xl font-medium",children:"View on Map"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:()=>s("symptomLog"),className:"py-3 bg-gray-200 text-gray-800 rounded-xl font-medium",children:"Log Symptoms"}),e.jsx("button",{onClick:w,className:"py-3 border border-gray-300 text-gray-700 rounded-xl font-medium",children:"Retake Photo"})]}),e.jsx("button",{onClick:p,className:"w-full py-2 text-gray-600 text-sm",children:"Submit Another Reading"})]})]})]})}return e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-20",children:[e.jsx("div",{className:"bg-white shadow-sm p-4 safe-area-top",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>s("home"),className:"mr-3 p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(q,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl font-semibold",children:"Submit Pollen Reading"})]})}),e.jsxs("div",{className:"p-4 space-y-4",children:[a?e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(O,{className:"w-4 h-4 text-green-600 mr-2"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-green-800",children:"Location set"}),e.jsx("p",{className:"text-xs text-green-700",children:((f=a.address)==null?void 0:f.split(",")[0])||"Current location"})]}),e.jsx("button",{onClick:()=>l(!0),className:"text-xs text-green-600 underline",children:"Change"})]})}):e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(O,{className:"w-4 h-4 text-yellow-600 mr-2"}),e.jsx("span",{className:"text-sm font-medium text-yellow-800",children:"Location required"})]}),e.jsx("button",{onClick:()=>l(!0),className:"text-sm text-yellow-600 underline",children:"Set location"})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsxs("h3",{className:"font-semibold mb-4 flex items-center",children:[e.jsx(B,{className:"w-5 h-5 mr-2 text-blue-600"}),"How to take a good photo"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center mr-3 mt-0.5",children:e.jsx("span",{className:"text-xs font-semibold text-blue-600",children:"1"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Place trap on flat surface"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Ensure the trap is stable and level"})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center mr-3 mt-0.5",children:e.jsx("span",{className:"text-xs font-semibold text-blue-600",children:"2"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Ensure good lighting"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Avoid shadows and direct sunlight"})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center mr-3 mt-0.5",children:e.jsx("span",{className:"text-xs font-semibold text-blue-600",children:"3"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Center trap in frame"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Use the guide lines to align properly"})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center mr-3 mt-0.5",children:e.jsx("span",{className:"text-xs font-semibold text-blue-600",children:"4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Hold camera steady"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Take a clear, focused photo"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-4",children:[e.jsx("h4",{className:"font-medium mb-3",children:"What pollen looks like"}),e.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"relative w-32 h-20 bg-yellow-100 rounded mx-auto mb-2",children:[...Array(8)].map((v,P)=>e.jsx("div",{className:"absolute w-1.5 h-1.5 bg-yellow-600 rounded-full",style:{top:`${20+Math.random()*60}%`,left:`${10+Math.random()*80}%`}},P))}),e.jsx("p",{className:"text-xs text-gray-600",children:"Pollen grains appear as small yellow/brown dots"})]})]}),e.jsxs("button",{onClick:()=>n(!0),disabled:!a,className:"w-full py-4 bg-blue-600 text-white rounded-xl font-medium flex items-center justify-center space-x-2 shadow-md disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(B,{className:"w-6 h-6"}),e.jsx("span",{children:"Open Camera"})]}),!a&&e.jsx("p",{className:"text-center text-sm text-gray-500",children:"Please set your location first"})]})]})}function pa({setScreen:s}){const{location:t}=J(),[a,r]=u.useState(!1),[n,o]=u.useState([]),[l,h]=u.useState(!0),[c,m]=u.useState("local"),[g,x]=u.useState(null);u.useEffect(()=>{b()},[t,c]);const b=async()=>{try{h(!0);let i;c==="local"&&t?i=await G.getLocalSubmissions(t.latitude,t.longitude,10):i=await G.getNationalSubmissions(),o(i||[])}catch(i){console.error("Failed to load map data:",i),o(S())}finally{h(!1)}},S=()=>{const i=[],y=(t==null?void 0:t.latitude)||40.7128,d=(t==null?void 0:t.longitude)||-74.006,f=c==="local"?.1:10;for(let v=0;v<(c==="local"?15:50);v++){const P=y+(Math.random()-.5)*f,_=d+(Math.random()-.5)*f,I=["very_low","low","moderate","high","very_high"],E=I[Math.floor(Math.random()*I.length)];i.push({id:`mock-${v}`,latitude:P,longitude:_,pollen_density:E,pollen_count:Math.floor(Math.random()*100)+5,confidence_score:.6+Math.random()*.4,created_at:new Date(Date.now()-Math.random()*7*24*60*60*1e3).toISOString(),address:`Location ${v+1}`})}return i},j=i=>({very_low:"#22c55e",low:"#22c55e",moderate:"#f59e0b",high:"#f97316",very_high:"#ef4444"})[i]||"#6b7280",N=i=>i<10?"w-3 h-3":i<30?"w-4 h-4":i<60?"w-5 h-5":"w-6 h-6",w=i=>{const y=new Date(i),f=Math.floor((new Date-y)/(1e3*60*60));return f<1?"Just now":f===1?"1 hour ago":f<24?`${f} hours ago`:`${Math.floor(f/24)} days ago`},p=i=>{r(!1),i&&c==="local"&&b()};return e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-20",children:[e.jsxs("div",{className:"bg-white shadow-sm p-4 safe-area-top",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>s("home"),className:"mr-3 p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(q,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl font-semibold",children:"Pollen Map"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:b,className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx($t,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>r(!0),className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(O,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1 mt-3",children:[e.jsx("button",{onClick:()=>m("local"),className:`flex-1 py-2 px-3 rounded-md text-sm font-medium transition-colors ${c==="local"?"bg-white text-blue-600 shadow-sm":"text-gray-600"}`,children:"Local Area"}),e.jsx("button",{onClick:()=>m("national"),className:`flex-1 py-2 px-3 rounded-md text-sm font-medium transition-colors ${c==="national"?"bg-white text-blue-600 shadow-sm":"text-gray-600"}`,children:"National View"})]})]}),c==="local"&&!t&&e.jsx("div",{className:"bg-yellow-50 border-b border-yellow-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"Set your location for local pollen data"}),e.jsx("p",{className:"text-xs text-yellow-700",children:"Showing national view instead"})]}),e.jsx("button",{onClick:()=>r(!0),className:"text-sm text-yellow-600 underline",children:"Set Location"})]})}),e.jsx("div",{className:"relative flex-1 bg-gray-100",children:l?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading pollen data..."})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"h-96 bg-gradient-to-br from-green-100 to-blue-100 relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 opacity-20",children:[[...Array(10)].map((i,y)=>e.jsx("div",{className:"absolute w-full h-px bg-gray-400",style:{top:`${y*10}%`}},`h-${y}`)),[...Array(10)].map((i,y)=>e.jsx("div",{className:"absolute h-full w-px bg-gray-400",style:{left:`${y*10}%`}},`v-${y}`))]}),t&&c==="local"&&e.jsx("div",{className:"absolute transform -translate-x-1/2 -translate-y-1/2 z-20",style:{top:"50%",left:"50%"},children:e.jsx("div",{className:"w-4 h-4 bg-blue-600 rounded-full border-2 border-white shadow-lg",children:e.jsx("div",{className:"w-8 h-8 bg-blue-600/20 rounded-full absolute -top-2 -left-2 animate-ping"})})}),n.map((i,y)=>{const d=c==="local"?50+(Math.random()-.5)*80:Math.random()*90+5,f=c==="local"?50+(Math.random()-.5)*80:Math.random()*90+5;return e.jsx("button",{onClick:()=>x(i),className:"absolute transform -translate-x-1/2 -translate-y-1/2 z-10 hover:scale-110 transition-transform",style:{top:`${f}%`,left:`${d}%`},children:e.jsx("div",{className:`${N(i.pollen_count)} rounded-full border-2 border-white shadow-lg`,style:{backgroundColor:j(i.pollen_density)}})},i.id)})]}),e.jsxs("div",{className:"absolute bottom-4 left-4 bg-white rounded-lg shadow-lg p-3 z-30",children:[e.jsxs("h4",{className:"font-semibold text-sm mb-2 flex items-center",children:[e.jsx(Gt,{className:"w-4 h-4 mr-1"}),"Pollen Levels"]}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full mr-2"}),e.jsx("span",{children:"Low (0-10)"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full mr-2"}),e.jsx("span",{children:"Moderate (11-30)"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full mr-2"}),e.jsx("span",{children:"High (31-60)"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full mr-2"}),e.jsx("span",{children:"Very High (60+)"})]})]})]}),e.jsx("div",{className:"absolute top-4 right-4 bg-white rounded-lg shadow-lg p-3 z-30",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold",children:n.length}),e.jsx("div",{className:"text-xs text-gray-500",children:"Reports"})]})})]})}),e.jsx("div",{className:"bg-white border-t border-gray-200 max-h-48 overflow-y-auto",children:e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Recent Submissions"}),e.jsx("div",{className:"space-y-2",children:n.slice(0,5).map(i=>e.jsxs("button",{onClick:()=>x(i),className:"w-full flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-3 h-3 rounded-full mr-3",style:{backgroundColor:j(i.pollen_density)}}),e.jsxs("div",{className:"text-left",children:[e.jsxs("p",{className:"text-sm font-medium capitalize",children:[i.pollen_density.replace("_"," ")," Level"]}),e.jsx("p",{className:"text-xs text-gray-500",children:i.address||"Unknown location"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium",children:i.pollen_count}),e.jsx("p",{className:"text-xs text-gray-500",children:w(i.created_at)})]})]},i.id))})]})}),a&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-sm w-full",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Set Map Location"}),e.jsx(Nt,{onLocationSet:p,showTitle:!1}),e.jsx("button",{onClick:()=>r(!1),className:"w-full mt-4 py-2 text-gray-600 text-sm",children:"Cancel"})]})}),g&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-sm w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Submission Details"}),e.jsx("button",{onClick:()=>x(null),className:"text-gray-400 hover:text-gray-600",children:"âœ•"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-4 h-4 rounded-full mr-3",style:{backgroundColor:j(g.pollen_density)}}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium capitalize",children:[g.pollen_density.replace("_"," ")," Level"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[g.pollen_count," grains detected"]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Confidence"}),e.jsxs("span",{className:"font-medium",children:[Math.round(g.confidence_score*100),"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm mt-1",children:[e.jsx("span",{className:"text-gray-600",children:"Submitted"}),e.jsx("span",{className:"font-medium",children:w(g.created_at)})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(O,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:g.address||"Location not available"})]})]}),e.jsx("button",{onClick:()=>x(null),className:"w-full mt-6 py-3 bg-blue-600 text-white rounded-lg font-medium",children:"Close"})]})})]})}function ya({setScreen:s}){const{user:t}=re(),[a,r]=u.useState([]),[n,o]=u.useState(!1),[l,h]=u.useState(new Date().toISOString().split("T")[0]),[c,m]=u.useState(!0);u.useEffect(()=>{g()},[l]);const g=async()=>{try{if(m(!0),t){const p=await G.getUserSymptoms(t.id,l);r(p||[])}else{const p=localStorage.getItem(`symptoms_${l}`);r(p?JSON.parse(p):[])}}catch(p){console.error("Failed to load symptoms:",p),r([])}finally{m(!1)}},x=async p=>{try{const i={id:Date.now().toString(),date:l,timestamp:new Date().toISOString(),user_id:(t==null?void 0:t.id)||null,...p};if(t)await G.saveSymptom(i);else{const y=[...a,i];r(y),localStorage.setItem(`symptoms_${l}`,JSON.stringify(y))}o(!1),g()}catch(i){console.error("Failed to save symptom:",i)}},b=async p=>{try{if(t)await G.deleteSymptom(p);else{const i=a.filter(y=>y.id!==p);r(i),localStorage.setItem(`symptoms_${l}`,JSON.stringify(i))}g()}catch(i){console.error("Failed to delete symptom:",i)}},S=p=>{const i={mild:"text-green-600 bg-green-50",moderate:"text-yellow-600 bg-yellow-50",severe:"text-red-600 bg-red-50"};return i[p]||i.mild},j=p=>{switch(p){case"mild":return"ðŸ˜Œ";case"moderate":return"ðŸ˜";case"severe":return"ðŸ˜£";default:return"ðŸ˜Œ"}},N=p=>new Date(p).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),w=({onClose:p,onSave:i})=>{const[y,d]=u.useState({type:"",severity:"mild",notes:"",triggers:[]}),f=["Sneezing","Runny nose","Stuffy nose","Itchy eyes","Watery eyes","Scratchy throat","Coughing","Headache","Fatigue","Other"],v=["Outdoor exposure","Open windows","Exercise outside","Gardening","Windy weather","High pollen count"],P=I=>{I.preventDefault(),y.type&&i(y)},_=I=>{d(E=>({...E,triggers:E.triggers.includes(I)?E.triggers.filter(L=>L!==I):[...E.triggers,I]}))};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Log Symptom"}),e.jsx("button",{onClick:p,className:"text-gray-400 hover:text-gray-600",children:"âœ•"})]}),e.jsxs("form",{onSubmit:P,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Symptom Type"}),e.jsxs("select",{value:y.type,onChange:I=>d({...y,type:I.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Select a symptom"}),f.map(I=>e.jsx("option",{value:I,children:I},I))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Severity"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:["mild","moderate","severe"].map(I=>e.jsx("button",{type:"button",onClick:()=>d({...y,severity:I}),className:`p-3 rounded-lg border-2 transition-colors ${y.severity===I?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl mb-1",children:j(I)}),e.jsx("div",{className:"text-sm font-medium capitalize",children:I})]})},I))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Possible Triggers"}),e.jsx("div",{className:"space-y-2",children:v.map(I=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:y.triggers.includes(I),onChange:()=>_(I),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:I})]},I))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (optional)"}),e.jsx("textarea",{value:y.notes,onChange:I=>d({...y,notes:I.target.value}),placeholder:"Any additional details...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:p,className:"flex-1 py-3 border border-gray-300 text-gray-700 rounded-lg font-medium",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 py-3 bg-blue-600 text-white rounded-lg font-medium",children:"Save Symptom"})]})]})]})})};return e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-20",children:[e.jsxs("div",{className:"bg-white shadow-sm p-4 safe-area-top",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>s("home"),className:"mr-3 p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(q,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl font-semibold",children:"Symptom Log"})]}),e.jsx("button",{onClick:()=>o(!0),className:"p-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:e.jsx(ke,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"mt-4",children:e.jsx("input",{type:"date",value:l,onChange:p=>h(p.target.value),max:new Date().toISOString().split("T")[0],className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})})]}),e.jsxs("div",{className:"p-4",children:[!t&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 mb-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-blue-600 mr-3",children:"â„¹ï¸"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-800 mb-1",children:"Anonymous Mode"}),e.jsx("p",{className:"text-xs text-blue-700",children:"Your symptoms are stored locally. Sign in to sync across devices and get personalized insights."})]})]})}),c?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No symptoms logged"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Track your allergy symptoms to identify patterns and triggers."}),e.jsxs("button",{onClick:()=>o(!0),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg font-medium",children:[e.jsx(ke,{className:"w-4 h-4 mr-2"}),"Log First Symptom"]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-4",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center",children:[e.jsx(Ft,{className:"w-4 h-4 mr-2"}),new Date(l).toLocaleDateString([],{weekday:"long",year:"numeric",month:"long",day:"numeric"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold",children:a.length}),e.jsx("div",{className:"text-xs text-gray-500",children:"Symptoms"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold",children:a.filter(p=>p.severity==="severe").length}),e.jsx("div",{className:"text-xs text-gray-500",children:"Severe"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold",children:[...new Set(a.map(p=>p.type))].length}),e.jsx("div",{className:"text-xs text-gray-500",children:"Types"})]})]})]}),e.jsx("div",{className:"space-y-3",children:a.map(p=>e.jsx("div",{className:"bg-white rounded-xl shadow-md p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"text-lg mr-2",children:j(p.severity)}),e.jsx("h4",{className:"font-medium",children:p.type}),e.jsx("span",{className:`ml-2 px-2 py-1 rounded-full text-xs font-medium ${S(p.severity)}`,children:p.severity})]}),p.triggers&&p.triggers.length>0&&e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Triggers:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:p.triggers.map((i,y)=>e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-xs rounded",children:i},y))})]}),p.notes&&e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:p.notes}),e.jsx("p",{className:"text-xs text-gray-500",children:N(p.timestamp)})]}),e.jsx("button",{onClick:()=>b(p.id),className:"ml-3 p-1 text-gray-400 hover:text-red-500",children:"ðŸ—‘ï¸"})]})},p.id))}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-4",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Quick Add"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:["Sneezing","Runny nose","Itchy eyes","Coughing"].map(p=>e.jsx("button",{onClick:()=>x({type:p,severity:"mild",triggers:[],notes:""}),className:"p-3 border border-gray-200 rounded-lg text-sm hover:bg-gray-50 transition-colors",children:p},p))})]}),t&&a.length>0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-4",children:[e.jsxs("h4",{className:"font-medium mb-3 flex items-center",children:[e.jsx(ge,{className:"w-4 h-4 mr-2"}),"This Week's Patterns"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Most common symptom:"}),e.jsx("span",{className:"font-medium",children:"Sneezing"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Peak time:"}),e.jsx("span",{className:"font-medium",children:"Morning (8-10 AM)"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Common trigger:"}),e.jsx("span",{className:"font-medium",children:"Outdoor exposure"})]})]}),e.jsx("button",{onClick:()=>s("insights"),className:"w-full mt-3 py-2 text-blue-600 text-sm font-medium",children:"View detailed insights â†’"})]})]})]}),n&&e.jsx(w,{onClose:()=>o(!1),onSave:x})]})}function va({setScreen:s}){const{user:t}=re(),[a,r]=u.useState([]),[n,o]=u.useState(!0),[l,h]=u.useState("all"),[c,m]=u.useState(null);u.useEffect(()=>{g()},[l]);const g=async()=>{try{if(o(!0),t){const i=await G.getUserSubmissions(t.id,l);r(i||[])}else{const i=localStorage.getItem("user_submissions"),y=i?JSON.parse(i):[],d=x(y,l);r(d)}}catch(i){console.error("Failed to load submissions:",i),r([])}finally{o(!1)}},x=(i,y)=>{const d=new Date,f=new Date;switch(y){case"week":f.setDate(d.getDate()-7);break;case"month":f.setMonth(d.getMonth()-1);break;default:return i}return i.filter(v=>new Date(v.created_at)>=f)},b=i=>{const y={very_low:{color:"text-green-600",bg:"bg-green-50",emoji:"ðŸŸ¢"},low:{color:"text-green-600",bg:"bg-green-50",emoji:"ðŸŸ¢"},moderate:{color:"text-yellow-600",bg:"bg-yellow-50",emoji:"ðŸŸ¡"},high:{color:"text-orange-600",bg:"bg-orange-50",emoji:"ðŸŸ "},very_high:{color:"text-red-600",bg:"bg-red-50",emoji:"ðŸ”´"}};return y[i]||y.moderate},S=i=>{const y=new Date(i),d=new Date,f=Math.floor((d-y)/(1e3*60*60*24));return f===0?"Today":f===1?"Yesterday":f<7?`${f} days ago`:y.toLocaleDateString([],{month:"short",day:"numeric",year:y.getFullYear()!==d.getFullYear()?"numeric":void 0})},j=i=>new Date(i).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),w=(()=>{var P;if(a.length===0)return null;const i=a.reduce((_,I)=>_+(I.pollen_count||0),0),y=Math.round(i/a.length),d=a.reduce((_,I)=>(_[I.pollen_density]=(_[I.pollen_density]||0)+1,_),{}),f=((P=Object.entries(d).sort(([,_],[,I])=>I-_)[0])==null?void 0:P[0])||"moderate",v=a.reduce((_,I)=>_+(I.confidence_score||0),0)/a.length;return{total:a.length,avgCount:y,mostCommonLevel:f,avgConfidence:Math.round(v*100)}})(),p=({submission:i,onClose:y})=>{var f,v;if(!i)return null;const d=b(i.pollen_density);return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Submission Details"}),e.jsx("button",{onClick:y,className:"text-gray-400 hover:text-gray-600",children:"âœ•"})]}),e.jsxs("div",{className:"space-y-4",children:[i.image_url&&e.jsx("div",{children:e.jsx("img",{src:i.image_url,alt:"Pollen trap",className:"w-full h-48 object-cover rounded-lg"})}),e.jsxs("div",{className:`p-4 rounded-lg ${d.bg}`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"text-2xl mr-3",children:d.emoji}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold capitalize",children:[i.pollen_density.replace("_"," ")," Level"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[i.pollen_count," grains detected"]})]})]}),e.jsx("p",{className:`text-sm ${d.color}`,children:i.advice||"Pollen level recorded for your area."})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Confidence:"}),e.jsxs("span",{className:"font-medium",children:[Math.round((i.confidence_score||0)*100),"%"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Date:"}),e.jsx("span",{className:"font-medium",children:new Date(i.created_at).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Time:"}),e.jsx("span",{className:"font-medium",children:j(i.created_at)})]})]}),i.location&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(O,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:i.location.address||`${(f=i.location.latitude)==null?void 0:f.toFixed(4)}, ${(v=i.location.longitude)==null?void 0:v.toFixed(4)}`})]}),i.weather_conditions&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("h5",{className:"font-medium text-sm mb-2",children:"Weather Conditions"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"font-medium",children:[i.weather_conditions.temperature,"Â°C"]}),e.jsx("div",{className:"text-gray-500",children:"Temp"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"font-medium",children:[i.weather_conditions.humidity,"%"]}),e.jsx("div",{className:"text-gray-500",children:"Humidity"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"font-medium",children:[i.weather_conditions.wind_speed," km/h"]}),e.jsx("div",{className:"text-gray-500",children:"Wind"})]})]})]}),i.plant_species&&i.plant_species.length>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-sm mb-2",children:"Detected Species"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:i.plant_species.map((P,_)=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:P},_))})]})]}),e.jsx("button",{onClick:y,className:"w-full mt-6 py-3 bg-blue-600 text-white rounded-lg font-medium",children:"Close"})]})})};return e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-20",children:[e.jsxs("div",{className:"bg-white shadow-sm p-4 safe-area-top",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>s("home"),className:"mr-3 p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(q,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl font-semibold",children:"My History"})]}),e.jsx("button",{onClick:()=>s("camera"),className:"p-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:e.jsx(B,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"flex bg-gray-100 rounded-lg p-1 mt-4",children:[{key:"all",label:"All Time"},{key:"month",label:"This Month"},{key:"week",label:"This Week"}].map(({key:i,label:y})=>e.jsx("button",{onClick:()=>h(i),className:`flex-1 py-2 px-3 rounded-md text-sm font-medium transition-colors ${l===i?"bg-white text-blue-600 shadow-sm":"text-gray-600"}`,children:y},i))})]}),e.jsxs("div",{className:"p-4",children:[!t&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 mb-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"text-blue-600 mr-3",children:"â„¹ï¸"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-800 mb-1",children:"Anonymous Mode"}),e.jsx("p",{className:"text-xs text-blue-700",children:"Your submissions are stored locally. Sign in to sync across devices and access full history."})]})]})}),n?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“Š"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No submissions yet"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Start tracking pollen levels to build your history and see trends over time."}),e.jsxs("button",{onClick:()=>s("camera"),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg font-medium",children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Submit First Reading"]})]}):e.jsxs("div",{className:"space-y-4",children:[w&&e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-4",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center",children:[e.jsx(ge,{className:"w-4 h-4 mr-2"}),l==="all"?"All Time":l==="month"?"This Month":"This Week"," Summary"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-semibold",children:w.total}),e.jsx("div",{className:"text-xs text-gray-500",children:"Submissions"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-semibold",children:w.avgCount}),e.jsx("div",{className:"text-xs text-gray-500",children:"Avg Grains"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold capitalize",children:w.mostCommonLevel.replace("_"," ")}),e.jsx("div",{className:"text-xs text-gray-500",children:"Most Common"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-semibold",children:[w.avgConfidence,"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Avg Confidence"})]})]})]}),e.jsx("div",{className:"space-y-3",children:a.map(i=>{var d;const y=b(i.pollen_density);return e.jsx("button",{onClick:()=>m(i),className:"w-full bg-white rounded-xl shadow-md p-4 hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx("span",{className:"text-2xl mr-3",children:y.emoji}),e.jsxs("div",{className:"text-left",children:[e.jsxs("h4",{className:"font-medium capitalize",children:[i.pollen_density.replace("_"," ")," Level"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[i.pollen_count," grains â€¢ ",Math.round((i.confidence_score||0)*100),"% confidence"]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[S(i.created_at)," at ",j(i.created_at)]})]})]}),e.jsxs("div",{className:"text-right",children:[i.location&&e.jsxs("div",{className:"flex items-center text-xs text-gray-500 mb-1",children:[e.jsx(O,{className:"w-3 h-3 mr-1"}),e.jsx("span",{className:"truncate max-w-20",children:((d=i.location.address)==null?void 0:d.split(",")[0])||"Location"})]}),e.jsx("div",{className:"text-xs text-gray-400",children:"Tap for details"})]})]})},i.id)})}),a.length>=3&&e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-4",children:[e.jsxs("h4",{className:"font-medium mb-3 flex items-center",children:[e.jsx(ge,{className:"w-4 h-4 mr-2"}),"Insights"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Trend:"}),e.jsx("span",{className:"font-medium text-green-600",children:"Improving â†—ï¸"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Best day:"}),e.jsx("span",{className:"font-medium",children:a.filter(i=>i.pollen_density==="low"||i.pollen_density==="very_low").slice(-1)[0]?S(a.filter(i=>i.pollen_density==="low"||i.pollen_density==="very_low").slice(-1)[0].created_at):"No low days yet"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Consistency:"}),e.jsx("span",{className:"font-medium",children:a.length>=7?"Great":"Keep tracking"})]})]}),t&&e.jsx("button",{onClick:()=>s("insights"),className:"w-full mt-3 py-2 text-blue-600 text-sm font-medium",children:"View detailed insights â†’"})]})]})]}),c&&e.jsx(p,{submission:c,onClose:()=>m(null)})]})}const St=30*60*1e3,ba=6*60*60*1e3,H=new Map,Ct=(s,t,a="current")=>{const r=Math.round(s*1e3)/1e3,n=Math.round(t*1e3)/1e3;return`weather_${a}_${r}_${n}`},Se=(s,t=St)=>s&&Date.now()-s.timestamp<t,wa=async(s,t,a="metric")=>{if(!s||!t)throw new Error("Latitude and longitude are required");const r=Ct(s,t,"current"),n=H.get(r);if(Se(n,St))return console.log("Returning cached current weather data"),n.data;try{return ze(s,t)}catch(o){return console.error("Failed to fetch current weather:",o),ze(s,t)}},ja=async(s,t,a=5,r="metric")=>{if(!s||!t)throw new Error("Latitude and longitude are required");const n=Ct(s,t,`forecast_${a}`),o=H.get(n);if(Se(o,ba))return console.log("Returning cached weather forecast data"),o.data;try{return Be(s,t,a)}catch(l){return console.error("Failed to fetch weather forecast:",l),Be(s,t,a)}},Na=(s,t)=>{var n,o,l,h,c,m,g,x,b,S,j,N,w,p,i,y,d,f;const a=t==="metric"?"Â°C":"Â°F",r=t==="metric"?"m/s":"mph";return{location:{name:s.name,country:(n=s.sys)==null?void 0:n.country,coordinates:{latitude:(o=s.coord)==null?void 0:o.lat,longitude:(l=s.coord)==null?void 0:l.lon}},current:{temperature:Math.round(((h=s.main)==null?void 0:h.temp)||0),temperatureUnit:a,feelsLike:Math.round(((c=s.main)==null?void 0:c.feels_like)||0),humidity:((m=s.main)==null?void 0:m.humidity)||0,pressure:((g=s.main)==null?void 0:g.pressure)||0,visibility:s.visibility?Math.round(s.visibility/1e3):null,uvIndex:null,windSpeed:((x=s.wind)==null?void 0:x.speed)||0,windDirection:((b=s.wind)==null?void 0:b.deg)||0,windUnit:r,cloudCover:((S=s.clouds)==null?void 0:S.all)||0,condition:{main:((N=(j=s.weather)==null?void 0:j[0])==null?void 0:N.main)||"Unknown",description:((p=(w=s.weather)==null?void 0:w[0])==null?void 0:p.description)||"Unknown",icon:((y=(i=s.weather)==null?void 0:i[0])==null?void 0:y.icon)||"01d"},sunrise:(d=s.sys)!=null&&d.sunrise?new Date(s.sys.sunrise*1e3).toISOString():null,sunset:(f=s.sys)!=null&&f.sunset?new Date(s.sys.sunset*1e3).toISOString():null},metadata:{fetchedAt:new Date().toISOString(),source:"openweathermap",units:t}}},Sa=(s,t,a)=>{var l,h,c,m,g,x,b;const r=t==="metric"?"Â°C":"Â°F",n=[],o={};return(l=s.list)==null||l.forEach(S=>{const j=new Date(S.dt*1e3).toISOString().split("T")[0];o[j]||(o[j]=[]),o[j].push(S)}),Object.entries(o).slice(0,a).forEach(([S,j])=>{const N=j.map(d=>d.main.temp),w=j.map(d=>d.weather[0]),p={};w.forEach(d=>{p[d.main]=(p[d.main]||0)+1});const i=Object.entries(p).sort(([,d],[,f])=>f-d)[0][0],y=w.find(d=>d.main===i);n.push({date:S,temperature:{min:Math.round(Math.min(...N)),max:Math.round(Math.max(...N)),unit:r},condition:{main:y.main,description:y.description,icon:y.icon},humidity:Math.round(j.reduce((d,f)=>d+f.main.humidity,0)/j.length),windSpeed:Math.round(j.reduce((d,f)=>{var v;return d+(((v=f.wind)==null?void 0:v.speed)||0)},0)/j.length),cloudCover:Math.round(j.reduce((d,f)=>{var v;return d+(((v=f.clouds)==null?void 0:v.all)||0)},0)/j.length),precipitation:j.some(d=>d.rain||d.snow)})}),{location:{name:(h=s.city)==null?void 0:h.name,country:(c=s.city)==null?void 0:c.country,coordinates:{latitude:(g=(m=s.city)==null?void 0:m.coord)==null?void 0:g.lat,longitude:(b=(x=s.city)==null?void 0:x.coord)==null?void 0:b.lon}},dailyForecasts:n,metadata:{fetchedAt:new Date().toISOString(),source:"openweathermap",units:t,forecastDays:a}}},ze=(s,t)=>{const a=[{main:"Clear",description:"clear sky",icon:"01d"},{main:"Clouds",description:"few clouds",icon:"02d"},{main:"Clouds",description:"scattered clouds",icon:"03d"},{main:"Rain",description:"light rain",icon:"10d"}],r=a[Math.floor(Math.random()*a.length)],n=Math.round(15+Math.random()*20);return{location:{name:"Mock Location",country:"US",coordinates:{latitude:s,longitude:t}},current:{temperature:n,temperatureUnit:"Â°C",feelsLike:n+Math.round((Math.random()-.5)*4),humidity:Math.round(40+Math.random()*40),pressure:Math.round(1e3+Math.random()*50),visibility:Math.round(5+Math.random()*15),uvIndex:Math.round(Math.random()*11),windSpeed:Math.round(Math.random()*20),windDirection:Math.round(Math.random()*360),windUnit:"m/s",cloudCover:Math.round(Math.random()*100),condition:r,sunrise:new Date(Date.now()-6*60*60*1e3).toISOString(),sunset:new Date(Date.now()+6*60*60*1e3).toISOString()},metadata:{fetchedAt:new Date().toISOString(),source:"mock_data",units:"metric"}}},Be=(s,t,a)=>{const r=[{main:"Clear",description:"clear sky",icon:"01d"},{main:"Clouds",description:"few clouds",icon:"02d"},{main:"Rain",description:"light rain",icon:"10d"}],n=[];for(let o=0;o<a;o++){const l=new Date;l.setDate(l.getDate()+o);const h=r[Math.floor(Math.random()*r.length)],c=20+Math.random()*15;n.push({date:l.toISOString().split("T")[0],temperature:{min:Math.round(c-5),max:Math.round(c+5),unit:"Â°C"},condition:h,humidity:Math.round(40+Math.random()*40),windSpeed:Math.round(Math.random()*15),cloudCover:Math.round(Math.random()*100),precipitation:Math.random()>.7})}return{location:{name:"Mock Location",country:"US",coordinates:{latitude:s,longitude:t}},dailyForecasts:n,metadata:{fetchedAt:new Date().toISOString(),source:"mock_data",units:"metric",forecastDays:a}}},Ca=(s,t)=>{const a=t==null?void 0:t.includes("d");switch(s==null?void 0:s.toLowerCase()){case"clear":return a?"â˜€ï¸":"ðŸŒ™";case"clouds":return a?"â›…":"â˜ï¸";case"rain":return"ðŸŒ§ï¸";case"drizzle":return"ðŸŒ¦ï¸";case"thunderstorm":return"â›ˆï¸";case"snow":return"â„ï¸";case"mist":case"fog":return"ðŸŒ«ï¸";default:return a?"ðŸŒ¤ï¸":"ðŸŒ™"}},Pa=()=>!0,_a=()=>{H.clear(),console.log("Weather cache cleared")},Ia=()=>{let s=0,t=0;for(const[a,r]of H.entries())Se(r)?s++:t++;return{totalEntries:H.size,validEntries:s,expiredEntries:t}},He={getCurrentWeather:wa,getWeatherForecast:ja,getWeatherEmoji:Ca,isConfigured:Pa,clearCache:_a,getCacheStats:Ia},ka=async()=>{var t,a,r,n,o,l,h,c;const s={timestamp:new Date().toISOString(),services:{}};try{const m=R.isConfigured();if(s.services.googleMaps={configured:m,status:m?"ready":"needs_api_key",message:m?"Google Maps API key found":"Add VITE_GOOGLE_MAPS_API_KEY to .env file"},m)try{const g=await R.geocodeAddress("New York, NY");s.services.googleMaps.geocoding="working",s.services.googleMaps.testLocation=g}catch(g){s.services.googleMaps.geocoding="error",s.services.googleMaps.error=g.message}}catch(m){s.services.googleMaps={configured:!1,status:"error",error:m.message}}try{const m="AIzaSyB_Fj3F0vAmvCNBGMGIN90fQtk85cuxj1s";s.services.googlePollen={configured:!!m,status:m?"ready":"using_mock_data",message:m?"Google Pollen API key found":"Using mock data - add VITE_GOOGLE_MAPS_API_KEY for real data"};try{const g=await le.getForecast(40.7128,-74.006,3);s.services.googlePollen.forecast="working",s.services.googlePollen.dataSource=((t=g.metadata)==null?void 0:t.source)||"unknown",s.services.googlePollen.sampleData={days:((a=g.dailyForecasts)==null?void 0:a.length)||0,firstDay:(n=(r=g.dailyForecasts)==null?void 0:r[0])==null?void 0:n.date}}catch(g){s.services.googlePollen.forecast="error",s.services.googlePollen.error=g.message}}catch(m){s.services.googlePollen={configured:!1,status:"error",error:m.message}}try{const m=He.isConfigured();s.services.googleWeather={configured:m,status:m?"ready":"using_mock_data",message:m?"Weather API configured":"Using mock data - add VITE_OPENWEATHER_API_KEY for real weather"};try{const g=await He.getCurrentWeather(40.7128,-74.006);s.services.googleWeather.current="working",s.services.googleWeather.dataSource=((o=g.metadata)==null?void 0:o.source)||"unknown",s.services.googleWeather.sampleData={temperature:(l=g.current)==null?void 0:l.temperature,condition:(c=(h=g.current)==null?void 0:h.condition)==null?void 0:c.main}}catch(g){s.services.googleWeather.current="error",s.services.googleWeather.error=g.message}}catch(m){s.services.googleWeather={configured:!1,status:"error",error:m.message}}try{const{default:m}=await Mt(async()=>{const{default:x}=await Promise.resolve().then(()=>Zs);return{default:x}},void 0),g=m.isConfigured();s.services.googleGeolocation={configured:g,status:g?"ready":"needs_api_key",message:g?"Google Geolocation API configured ($5 per 1,000 requests)":"Add VITE_GOOGLE_MAPS_API_KEY to enable geolocation without GPS"},g&&(s.services.googleGeolocation.note="API ready - test manually to avoid charges")}catch(m){s.services.googleGeolocation={configured:!1,status:"error",error:m.message}}return s},Ma=()=>({required:[],optional:[],status:"complete"}),La=()=>`# CrowdPollen - Simplified 3-Provider Setup
# Copy this to .env and add your API keys

# 1ï¸âƒ£ SUPABASE (Required for database & auth)
VITE_SUPABASE_URL=your_supabase_project_url
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key

# 2ï¸âƒ£ GOOGLE CLOUD (Required for maps, pollen & weather)
VITE_GOOGLE_MAPS_API_KEY=your_google_cloud_api_key

# 3ï¸âƒ£ HUGGING FACE (Optional - for AI pollen detection)
VITE_HUGGINGFACE_API_TOKEN=your_huggingface_token

# ðŸ”§ App Configuration
VITE_APP_ENV=development
VITE_ENABLE_ANALYTICS=false
`,Ea=()=>{const[s,t]=u.useState(null),[a,r]=u.useState(!1),[n,o]=u.useState(null),[l,h]=u.useState(!1);u.useEffect(()=>{const x=Ma();o(x)},[]);const c=async()=>{r(!0);try{const x=await ka();t(x)}catch(x){console.error("Test failed:",x),t({error:x.message,timestamp:new Date().toISOString()})}finally{r(!1)}},m=x=>{switch(x){case"ready":return"text-green-600 bg-green-50";case"working":return"text-green-600 bg-green-50";case"using_mock_data":return"text-yellow-600 bg-yellow-50";case"needs_api_key":return"text-orange-600 bg-orange-50";case"error":return"text-red-600 bg-red-50";default:return"text-gray-600 bg-gray-50"}},g=x=>{switch(x){case"ready":return"âœ…";case"working":return"âœ…";case"using_mock_data":return"ðŸ”„";case"needs_api_key":return"âš ï¸";case"error":return"âŒ";default:return"â“"}};return e.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-lg",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"ðŸ§ª CrowdPollen API Test Panel"}),e.jsx("p",{className:"text-gray-600",children:"Test your API configuration and see what's working"})]}),n&&e.jsxs("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-blue-900 mb-3",children:["ðŸ“‹ Setup Status: ",n.status==="complete"?"âœ… Complete":"âš ï¸ Incomplete"]}),n.required.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"font-medium text-red-700 mb-2",children:"Required API Keys Missing:"}),e.jsx("ul",{className:"space-y-1",children:n.required.map((x,b)=>e.jsxs("li",{className:"text-sm text-red-600",children:["â€¢ ",e.jsx("code",{className:"bg-red-100 px-1 rounded",children:x.key})," - ",x.description]},b))})]}),n.optional.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"font-medium text-yellow-700 mb-2",children:"Optional API Keys (using fallbacks):"}),e.jsx("ul",{className:"space-y-1",children:n.optional.map((x,b)=>e.jsxs("li",{className:"text-sm text-yellow-600",children:["â€¢ ",e.jsx("code",{className:"bg-yellow-100 px-1 rounded",children:x.key})," - ",x.description]},b))})]}),e.jsxs("button",{onClick:()=>h(!l),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:[l?"Hide":"Show"," .env Template"]}),l&&e.jsx("div",{className:"mt-3",children:e.jsx("pre",{className:"bg-gray-900 text-green-400 p-3 rounded text-xs overflow-x-auto",children:La()})})]}),e.jsx("div",{className:"mb-6",children:e.jsx("button",{onClick:c,disabled:a,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-300 text-white px-6 py-3 rounded-lg font-medium transition-colors",children:a?"ðŸ”„ Testing APIs...":"ðŸ§ª Test All APIs"})}),s&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Results"}),e.jsx("span",{className:"text-sm text-gray-500",children:new Date(s.timestamp).toLocaleString()})]}),s.error?e.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("p",{className:"text-red-700",children:["âŒ Test failed: ",s.error]})}):e.jsx("div",{className:"grid gap-4",children:Object.entries(s.services).map(([x,b])=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 capitalize",children:x.replace(/([A-Z])/g," $1").trim()}),e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${m(b.status)}`,children:[g(b.status)," ",b.status.replace(/_/g," ")]})]}),e.jsx("p",{className:"text-gray-600 mb-3",children:b.message}),b.configured!==void 0&&e.jsxs("div",{className:"text-sm text-gray-500 mb-2",children:["API Key: ",b.configured?"âœ… Found":"âŒ Missing"]}),b.dataSource&&e.jsxs("div",{className:"text-sm text-gray-500 mb-2",children:["Data Source: ",e.jsx("code",{className:"bg-gray-100 px-1 rounded",children:b.dataSource})]}),b.sampleData&&e.jsxs("div",{className:"text-sm text-gray-500 mb-2",children:["Sample Data: ",JSON.stringify(b.sampleData,null,2)]}),b.testLocation&&e.jsxs("div",{className:"text-sm text-gray-500 mb-2",children:["Test Location: ",b.testLocation.address,"(",b.testLocation.latitude,", ",b.testLocation.longitude,")"]}),b.error&&e.jsxs("div",{className:"text-sm text-red-600 bg-red-50 p-2 rounded",children:["Error: ",b.error]}),x==="googleMaps"&&b.geocoding&&e.jsxs("div",{className:"text-sm text-green-600",children:["âœ… Geocoding: ",b.geocoding]}),x==="googlePollen"&&b.forecast&&e.jsxs("div",{className:"text-sm text-green-600",children:["âœ… Forecast: ",b.forecast]}),x==="googleWeather"&&b.current&&e.jsxs("div",{className:"text-sm text-green-600",children:["âœ… Current Weather: ",b.current]})]},x))})]}),e.jsxs("div",{className:"mt-8 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"ðŸš€ Quick Setup"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"1. Copy .env.example to .env:"})," ",e.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"cp .env.example .env"})]}),e.jsx("p",{children:e.jsx("strong",{children:"2. Add your API keys to .env file"})}),e.jsxs("p",{children:[e.jsx("strong",{children:"3. Restart the development server:"})," ",e.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"npm run dev"})]}),e.jsx("p",{children:e.jsx("strong",{children:'4. Click "Test All APIs" to verify setup'})})]})]})]})};function Aa(){var P,_,I,E;const s=ue(),{user:t,signOut:a}=re(),{location:r,clearLocation:n,useGoogleGeolocation:o,updateGeolocationPreference:l,isGoogleGeolocationConfigured:h}=J(),{preferences:c,updatePreferences:m}=yt(),[g,x]=u.useState(!1),[b,S]=u.useState(!1),[j,N]=u.useState(!1);u.useEffect(()=>{const L=localStorage.getItem("darkMode")==="true";N(L)},[]);const w=()=>{const L=!j;N(L),localStorage.setItem("darkMode",L.toString()),L?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},p=async()=>{try{await a(),s("/")}catch(L){console.error("Sign out error:",L)}},i=()=>{try{const L={submissions:JSON.parse(localStorage.getItem("user_submissions")||"[]"),symptoms:Object.keys(localStorage).filter(A=>A.startsWith("symptoms_")).reduce((A,D)=>(A[D]=JSON.parse(localStorage.getItem(D)||"[]"),A),{}),preferences:c,location:r,exportDate:new Date().toISOString()},C=new Blob([JSON.stringify(L,null,2)],{type:"application/json"}),k=URL.createObjectURL(C),M=document.createElement("a");M.href=k,M.download=`crowdpollen-data-${new Date().toISOString().split("T")[0]}.json`,M.click(),URL.revokeObjectURL(k)}catch(L){console.error("Export failed:",L),alert("Failed to export data")}},y=()=>{try{Object.keys(localStorage).filter(C=>C.startsWith("symptoms_")||C==="user_submissions"||C==="notification_preferences"||C==="user_location").forEach(C=>localStorage.removeItem(C)),n(),x(!1),alert("All data cleared successfully")}catch(L){console.error("Clear data failed:",L),alert("Failed to clear data")}},d=({icon:L,title:C,subtitle:k,action:M,danger:A=!1,showChevron:D=!0})=>e.jsxs("button",{onClick:M,className:`w-full flex items-center justify-between p-4 hover:bg-gray-50 transition-colors ${A?"text-red-600":"text-gray-900"}`,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(L,{className:`w-5 h-5 mr-3 ${A?"text-red-500":"text-gray-500"}`}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:`font-medium ${A?"text-red-600":"text-gray-900"}`,children:C}),k&&e.jsx("p",{className:"text-sm text-gray-500",children:k})]})]}),D&&e.jsx(Je,{className:"w-4 h-4 text-gray-400"})]}),f=({icon:L,title:C,subtitle:k,value:M,onChange:A})=>e.jsxs("div",{className:"flex items-center justify-between p-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(L,{className:"w-5 h-5 mr-3 text-gray-500"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:C}),k&&e.jsx("p",{className:"text-sm text-gray-500",children:k})]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:M,onChange:D=>A(D.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-500"})]})]}),v=({title:L,children:C})=>e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide mb-3 px-4",children:L}),e.jsx("div",{className:"bg-white rounded-xl border border-gray-100 overflow-hidden",children:C})]});return e.jsxs("div",{className:"min-h-screen bg-white pb-20",children:[e.jsx("div",{className:"px-6 pt-12 pb-6",children:e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("button",{onClick:()=>s("/"),className:"mr-4 p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(q,{className:"w-5 h-5 text-gray-600"})}),e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Settings"})]})}),e.jsxs("div",{className:"px-6",children:[e.jsx(v,{title:"Account",children:t?e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(Ke,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:t.email}),e.jsxs("p",{className:"text-sm text-gray-500",children:[((P=t.user_metadata)==null?void 0:P.account_type)||"Individual"," account"]})]})]})}):e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Sign In"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Sync data across devices"})]}),e.jsx("button",{onClick:()=>s("/auth"),className:"px-4 py-2 bg-blue-500 text-white rounded-lg text-sm font-medium hover:bg-blue-600 transition-colors",children:"Sign In"})]})})}),e.jsxs(v,{title:"Notifications",children:[e.jsx(f,{icon:me,title:"High Pollen Alerts",subtitle:"Get notified when pollen levels are high",value:c.highPollenAlerts,onChange:L=>m({highPollenAlerts:L})}),e.jsx("div",{className:"border-t border-gray-100",children:e.jsx(f,{icon:me,title:"Symptom Reminders",subtitle:"Daily reminders to log symptoms",value:c.symptomReminders,onChange:L=>m({symptomReminders:L})})}),e.jsx("div",{className:"border-t border-gray-100",children:e.jsx(f,{icon:me,title:"Weekly Reports",subtitle:"Get weekly summaries",value:c.weeklyReports,onChange:L=>m({weeklyReports:L})})})]}),e.jsxs(v,{title:"Location",children:[e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(O,{className:"w-5 h-5 mr-3 text-gray-500"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Current Location"}),e.jsx("p",{className:"text-sm text-gray-500",children:r?((_=r.address)==null?void 0:_.split(",")[0])||`${(I=r.latitude)==null?void 0:I.toFixed(4)}, ${(E=r.longitude)==null?void 0:E.toFixed(4)}`:"Not set"})]})]}),e.jsx("button",{onClick:()=>s("/location"),className:"text-blue-500 text-sm font-medium hover:text-blue-600 transition-colors",children:r?"Change":"Set"})]})}),h&&e.jsx("div",{className:"border-t border-gray-100",children:e.jsx(f,{icon:Me,title:"Use Google Geolocation",subtitle:"Get location without GPS permission (costs $5 per 1,000 requests)",value:o,onChange:l})})]}),e.jsx(v,{title:"Appearance",children:e.jsx(f,{icon:j?Ut:Wt,title:"Dark Mode",subtitle:"Use dark theme",value:j,onChange:w})}),e.jsxs(v,{title:"Data & Privacy",children:[e.jsx(d,{icon:zt,title:"Export Data",subtitle:"Download your data",action:i}),e.jsx("div",{className:"border-t border-gray-100",children:e.jsx(d,{icon:Bt,title:"Privacy Policy",subtitle:"How we protect your data",action:()=>window.open("https://crowdpollen.com/privacy","_blank")})}),e.jsx("div",{className:"border-t border-gray-100",children:e.jsx(d,{icon:Me,title:"Terms of Service",subtitle:"Terms and conditions",action:()=>window.open("https://crowdpollen.com/terms","_blank")})})]}),e.jsx(v,{title:"Developer Tools",children:e.jsx(d,{icon:qe,title:"API Test Panel",subtitle:"Test API configuration and connections",action:()=>S(!b),showChevron:!1})}),b&&e.jsx("div",{className:"mb-8",children:e.jsx(Ea,{})}),e.jsxs(v,{title:"Support",children:[e.jsx(d,{icon:Le,title:"Help & FAQ",subtitle:"Common questions",action:()=>s("/help")}),e.jsx("div",{className:"border-t border-gray-100",children:e.jsx(d,{icon:Le,title:"Contact Support",subtitle:"Get technical help",action:()=>window.open("mailto:support@crowdpollen.com")})})]}),e.jsxs(v,{title:"Danger Zone",children:[e.jsx(d,{icon:Ee,title:"Clear All Data",subtitle:"Permanently delete local data",action:()=>x(!0),danger:!0}),t&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"border-t border-gray-100",children:e.jsx(d,{icon:Ht,title:"Sign Out",subtitle:"Sign out of your account",action:p,danger:!0})})})]}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"CrowdPollen v1.0.0"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Built with â¤ï¸ for citizen science"})]})]}),g&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-6 z-50",children:e.jsx("div",{className:"bg-white rounded-2xl p-6 max-w-sm w-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Ee,{className:"w-8 h-8 text-red-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Clear All Data?"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"This will permanently delete all your submissions, symptoms, and settings. This action cannot be undone."}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:()=>x(!1),className:"flex-1 py-3 border border-gray-200 text-gray-700 rounded-xl font-medium hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:y,className:"flex-1 py-3 bg-red-500 text-white rounded-xl font-medium hover:bg-red-600 transition-colors",children:"Delete All"})]})]})})})]})}function Ta({onComplete:s}){const[t,a]=u.useState(0),r=[{title:"Welcome to CrowdPollen",subtitle:"Help track pollen levels in your community",icon:"ðŸŒ»",content:"Join thousands of citizen scientists collecting real-time pollen data to help everyone manage their allergies better."},{title:"Take Photos",subtitle:"Capture pollen trap images",icon:B,content:"Use your phone's camera to photograph pollen traps. Our AI will analyze the images to count pollen grains."},{title:"Share Location",subtitle:"Help map pollen levels",icon:O,content:"Share your location to contribute to neighborhood pollen maps. You can use GPS or enter your ZIP code."},{title:"Track Symptoms",subtitle:"Monitor your health",icon:Vt,content:"Log your allergy symptoms to see how they correlate with local pollen levels and get personalized insights."}],n=()=>{t<r.length-1?a(t+1):s()},o=()=>{s()},l=r[t],h=l.icon;return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-500 to-blue-600 flex flex-col",children:[e.jsx("div",{className:"flex justify-end p-4 safe-area-top",children:e.jsx("button",{onClick:o,className:"text-white/80 hover:text-white text-sm font-medium",children:"Skip"})}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center px-6 text-center text-white",children:[e.jsx("div",{className:"mb-8",children:typeof h=="string"?e.jsx("div",{className:"text-6xl",children:h}):e.jsx("div",{className:"w-20 h-20 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(h,{className:"w-10 h-10"})})}),e.jsx("h1",{className:"text-3xl font-bold mb-4",children:l.title}),e.jsx("h2",{className:"text-xl font-medium mb-6 opacity-90",children:l.subtitle}),e.jsx("p",{className:"text-lg opacity-80 leading-relaxed max-w-sm",children:l.content})]}),e.jsxs("div",{className:"p-6 safe-area-bottom",children:[e.jsx("div",{className:"flex justify-center mb-8",children:r.map((c,m)=>e.jsx("div",{className:`w-2 h-2 rounded-full mx-1 transition-colors ${m===t?"bg-white":"bg-white/30"}`},m))}),e.jsxs("button",{onClick:n,className:"w-full bg-white text-blue-600 py-4 rounded-xl font-semibold text-lg flex items-center justify-center hover:bg-gray-50 transition-colors",children:[t<r.length-1?"Next":"Get Started",e.jsx(Je,{className:"w-5 h-5 ml-2"})]})]})]})}function Da(){return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-500 to-blue-600 flex flex-col items-center justify-center",children:e.jsxs("div",{className:"text-center text-white",children:[e.jsx("div",{className:"text-6xl mb-6",children:"ðŸŒ»"}),e.jsx("h1",{className:"text-3xl font-bold mb-4",children:"CrowdPollen"}),e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})}),e.jsx("p",{className:"text-white/80",children:"Loading..."})]})})}class Ra extends u.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,a){this.setState({error:t,errorInfo:a})}render(){return this.state.hasError?e.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center p-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 max-w-md w-full text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ˜µ"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Oops! Something went wrong"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"We're sorry, but something unexpected happened. Please try refreshing the page."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"w-full bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Refresh Page"}),!1]})}):this.props.children}}function Oa(){const[s,t]=u.useState(!0),[a,r]=u.useState(!1);u.useEffect(()=>{setTimeout(()=>{const l=localStorage.getItem("crowdpollen_onboarding_completed");r(!!l),t(!1)},1e3)},[]);const n=()=>{localStorage.setItem("crowdpollen_onboarding_completed","true"),r(!0)};return s?e.jsx(Da,{}):a?e.jsx(Ra,{children:e.jsx(Vs,{future:{v7_relativeSplatPath:!0},children:e.jsx(Js,{children:e.jsx(Qs,{children:e.jsx(Xs,{children:e.jsxs("div",{className:"min-h-screen bg-neutral-50",children:[e.jsx("main",{className:"pb-16 safe-bottom",children:e.jsxs(zs,{children:[e.jsx(F,{path:"/",element:e.jsx(xa,{})}),e.jsx(F,{path:"/camera",element:e.jsx(fa,{})}),e.jsx(F,{path:"/map",element:e.jsx(pa,{})}),e.jsx(F,{path:"/symptoms",element:e.jsx(ya,{})}),e.jsx(F,{path:"/history",element:e.jsx(va,{})}),e.jsx(F,{path:"/settings",element:e.jsx(Aa,{})}),e.jsx(F,{path:"*",element:e.jsx(Us,{to:"/",replace:!0})})]})}),e.jsx(sa,{})]})})})})})}):e.jsx(Ta,{onComplete:n})}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(s=>{console.log("SW registered: ",s)}).catch(s=>{console.log("SW registration failed: ",s)})});fe.createRoot(document.getElementById("root")).render(e.jsx(It.StrictMode,{children:e.jsx(Oa,{})}));
//# sourceMappingURL=index-C9fPvoz2.js.map
